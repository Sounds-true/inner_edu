# Implementation Plan: Onboarding –≤ –ü–æ–Ω–∏–º–∞–ª–∏—é

**Ticket:** `01-FEAT-edu-bot-mvp`
**Plan ID:** `IP-02-onboarding-ponimaliya`
**Date:** 2025-11-07
**Status:** Draft
**Dependencies:** –ë–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏–∑ `docs/concepts/child start.md`

---

## –°–º—ã—Å–ª –∏ —Ü–µ–ª—å –∑–∞–¥–∞—á–∏

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–π –≤—Ö–æ–¥ —Ä–µ–±–µ–Ω–∫–∞ –≤ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –º–µ—Ç–∞—Ñ–æ—Ä—É "–ü–æ–Ω–∏–º–∞–ª–∏–∏" - —Å—Ç—Ä–∞–Ω—ã, –≥–¥–µ —Å–º—ã—Å–ª—ã –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–ª–æ–≤–∞. –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤–µ—Å—Ç–∏ –æ—Ç —É—á–µ–±–Ω—ã—Ö —Ç—Ä—É–¥–Ω–æ—Å—Ç–µ–π –∫ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—é —á–µ—Ä–µ–∑ –∏–≥—Ä–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É, –±–µ–∑ –ø—Ä—è–º–æ–≥–æ "–ª–µ—á–µ–Ω–∏—è". –†–µ–±–µ–Ω–æ–∫ —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–µ–¥–º–µ—Ç, –≥–¥–µ —Å–ª–æ–∂–Ω–æ, –∑–∞—Ç–µ–º —Ç–∏–ø —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (—Å–º—ã—Å–ª/–ø–∞–º—è—Ç—å/–≤–Ω–∏–º–∞–Ω–∏–µ/–º–æ—Ç–∏–≤–∞—Ü–∏—è), –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º - –∫–∞–∫ —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç. –≠—Ç–æ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –æ–±—É—á–µ–Ω–∏—è –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–≤–µ—Å—Ç–æ–≤.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞

**1. Scenario Files** (`src/data/scenarios/onboarding/`)
- `01_greeting.yaml` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–ø—É—Ç–Ω–∏–∫–∞ –∏–∑ –ü–æ–Ω–∏–º–∞–ª–∏–∏ (3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞ + 3 –∫–Ω–æ–ø–∫–∏)
- `02_subject_survey.yaml` - –æ–ø—Ä–æ—Å –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º (—Ä—É—Å—Å–∫–∏–π/–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞/–∏—Å—Ç–æ—Ä–∏—è/–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞/–±–∏–æ–ª–æ–≥–∏—è/–¥—Ä—É–≥–æ–µ)
- `03_difficulty_type.yaml` - —Ç–∏–ø —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–ø–æ–Ω—è—Ç—å —Å–º—ã—Å–ª/–∑–∞–ø–æ–º–Ω–∏—Ç—å/—Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è/–∏–Ω—Ç–µ—Ä–µ—Å)
- `04_emotion_bridge.yaml` - –ø–µ—Ä–µ—Ö–æ–¥ –∫ —ç–º–æ—Ü–∏—è–º ("–ê –∫–∞–∫ —Ç—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—à—å?")
- `05_emotion_choice.yaml` - –≤—ã–±–æ—Ä —ç–º–æ—Ü–∏–∏ (–∑–ª—é—Å—å/–≥—Ä—É—â—É/—Å—Ç—ã–¥–Ω–æ/–±–æ—é—Å—å/–Ω–∏—á–µ–≥–æ)
- `06_location_intro.yaml` - –ø–æ–∫–∞–∑ –∫–∞—Ä—Ç—ã –ü–æ–Ω–∏–º–∞–ª–∏–∏ (5 –ª–æ–∫–∞—Ü–∏–π)
- `07_first_quest_start.yaml` - –∑–∞–ø—É—Å–∫ –ø–µ—Ä–≤–æ–≥–æ –º–∏–∫—Ä–æ–∫–≤–µ—Å—Ç–∞

**2. Emotional State Handlers** (`src/psychology/emotional_router.py`)
- `EmotionalRouter` –∫–ª–∞—Å—Å —Å 5 —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏:
  - `tiredness` ‚Üí –∫–æ—Ä–æ—Ç–∫–∏–µ —Ñ—Ä–∞–∑—ã, –º–∏–Ω–∏-–∏–≥—Ä–∞ "–ü–æ–π–º–∞–π –¥—ã—Ö–∞–Ω–∏–µ"
  - `anxiety` ‚Üí —Ç–µ–ø–ª—ã–π —é–º–æ—Ä, "–ü–æ–π–º–∞–π –∑–≤–µ–∑–¥–æ—á–∫—É"
  - `anger` ‚Üí –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–æ–Ω, "–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ–∂–∂–µ–Ω–∏–µ"
  - `interest` ‚Üí –∫–≤–µ—Å—Ç–æ–≤–∞—è –ø–æ–¥–∞—á–∞
  - `doubt` ‚Üí –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π —Ç–æ–Ω

**3. Learning Profile** (`src/edu/learning_profile.py`)
- `LearningProfile` –∫–ª–∞—Å—Å —Å 4 –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏:
  - `understanding_meaning` - –Ω–µ –ø–æ–Ω–∏–º–∞—é —Å–º—ã—Å–ª
  - `memory` - –Ω–µ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è
  - `attention` - –Ω–µ –º–æ–≥—É —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è
  - `motivation` - –Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ
- –ú–∞–ø–ø–∏–Ω–≥ –Ω–∞ –ª–æ–∫–∞—Ü–∏–∏ –ü–æ–Ω–∏–º–∞–ª–∏–∏
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∫–≤–µ—Å—Ç–∞

**4. Mini-Games** (`src/game/mini_games/`)
- `catch_breath_dbt.py` - –¥—ã—Ö–∞–Ω–∏–µ 4-6 (–¥–ª—è —É—Å—Ç–∞–ª–æ—Å—Ç–∏)
- `catch_star_breathing.py` - –∑–≤–µ–∑–¥–æ—á–∫–∞ —Ä–∏—Ç–º–æ–º –≤–¥–æ—Ö–æ–≤ (–¥–ª—è —Ç—Ä–µ–≤–æ–≥–∏)
- `virtual_burn.py` - —Å–æ–∂–∂–µ–Ω–∏–µ —Ñ—Ä—É—Å—Ç—Ä–∞—Ü–∏–∏ (–¥–ª—è –∑–ª–æ—Å—Ç–∏)
- `draw_three_lines.py` - –Ω–∞—Ä–∏—Å—É–π –¥–µ–Ω—å —Ç—Ä–µ–º—è –ª–∏–Ω–∏—è–º–∏ (–¥–ª—è —É—Å—Ç–∞–ª–æ—Å—Ç–∏)

**5. User Profile Schema** (`src/storage/user_profile.py`)
–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```
{
  "onboarding": {
    "completed": false,
    "current_step": "greeting",
    "chosen_subject": null,
    "difficulty_type": null,
    "emotional_state": null,
    "entry_button": null  // yes_understand / not_sure / tired
  },
  "learning_profile": {
    "understanding_meaning": 0,
    "memory": 0,
    "attention": 0,
    "motivation": 0
  },
  "emotional_profile": {
    "primary_emotion": null,  // anger / sadness / shame / fear / numbness
    "router_state": null      // tiredness / anxiety / anger / interest / doubt
  }
}
```

**6. Location Metadata** (`src/data/locations_metadata.json`)
–ú–∞–ø–ø–∏–Ω–≥ 7 –ª–æ–∫–∞—Ü–∏–π –ü–æ–Ω–∏–º–∞–ª–∏–∏:
```json
{
  "tower_of_confusion": {
    "name": "–ë–∞—à–Ω—è –ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏—è",
    "emoji": "üåÜ",
    "learning_problem": "understanding_meaning",
    "modules": ["06", "03"],
    "unlock_condition": "always"
  },
  "valley_of_words": {...},
  "mountain_of_emptiness": {...},
  "forest_of_calm": {...},
  "city_of_mind": {...},
  "workshop_of_creator": {...},
  "bridge_of_actions": {...}
}
```

---

## –ü–æ–ª–Ω—ã–π flow —Ä–∞–±–æ—Ç—ã –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—Ö–æ–¥ (–∫–Ω–æ–ø–∫–∞ "–î–∞, —Ö–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è")

**–®–∞–≥ 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ**
```
Telegram: /start

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ 1:
"–ü—Ä–∏–≤–µ—Ç! –ò–Ω–æ–≥–¥–∞ —É—á—ë–±–∞ –±—ã–≤–∞–µ—Ç –∫–∞–∫ –ª–∞–±–∏—Ä–∏–Ω—Ç:
–≤—Ä–æ–¥–µ –∏–¥—ë—à—å ‚Äî –∞ –≤—ã—Ö–æ–¥ –≥–¥–µ-—Ç–æ —Ç–µ—Ä—è–µ—Ç—Å—è."

[–ü–∞—É–∑–∞ 1 —Å–µ–∫]

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ 2:
"–ë—ã–≤–∞–µ—Ç, —á—Ç–æ –∫–∞–∫–∏–µ-—Ç–æ –ø—Ä–µ–¥–º–µ—Ç—ã –∏–¥—É—Ç –ª–µ–≥–∫–æ,
–∞ –Ω–∞ –¥—Ä—É–≥–∏—Ö –º—ã—Å–ª–∏ –ø—É—Ç–∞—é—Ç—Å—è?"

[–ü–∞—É–∑–∞ 0.8 —Å–µ–∫]

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ 3:
"–Ø ‚Äî —Ç–≤–æ–π —Å–ø—É—Ç–Ω–∏–∫ –∏–∑ –ü–æ–Ω–∏–º–∞–ª–∏–∏.
–¢–∞–º –∂–∏–≤—É—Ç —Å–º—ã—Å–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–≤–æ–∏ —Å–ª–æ–≤–∞.
–ü–æ–ø—Ä–æ–±—É–µ–º –≤–º–µ—Å—Ç–µ –∏—Ö –≤–µ—Ä–Ω—É—Ç—å?"

[Inline –∫–Ω–æ–ø–∫–∏]
üåü –î–∞, —Ö–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è
ü§î –ù–µ –∑–Ω–∞—é, –ø–æ–ª—É—á–∏—Ç—Å—è –ª–∏
üò¥ –£ –º–µ–Ω—è —É—Å—Ç–∞–ª–æ—Å—Ç—å
```

**–î–∞–Ω–Ω—ã–µ:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è `user_profile` –≤ `data/profiles/{user_id}.json`
- `onboarding.current_step = "greeting"`

**–®–∞–≥ 2: –û–ø—Ä–æ—Å –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª: "üåü –î–∞, —Ö–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è"

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç: entry_button = "yes_understand"
–ë–æ—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç: router_state = "interest"

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
"–í—ã–±–µ—Ä–∏ –ø—Ä–µ–¥–º–µ—Ç, –≥–¥–µ —Å–µ–π—á–∞—Å —á–∞—â–µ –≤—Å–µ–≥–æ —Ç–µ—Ä—è–µ—à—å –Ω–∏—Ç—å."

[Inline –∫–Ω–æ–ø–∫–∏ - —Å–µ—Ç–∫–∞ 2x3]
üìù –†—É—Å—Å–∫–∏–π —è–∑—ã–∫       üî¢ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞
üìö –ò—Å—Ç–æ—Ä–∏—è            üìñ –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞
üß™ –ë–∏–æ–ª–æ–≥–∏—è          ‚ûï –î—Ä—É–≥–æ–µ
```

**–î–∞–Ω–Ω—ã–µ:**
- `onboarding.current_step = "subject_survey"`

**–®–∞–≥ 3: –¢–∏–ø —Å–ª–æ–∂–Ω–æ—Å—Ç–∏**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª: "üî¢ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç: chosen_subject = "mathematics"

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞. –•–æ—Ä–æ—à–æ.
–ß—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–∞–º —Å–ª–æ–∂–Ω–µ–µ:

üîç –ø–æ–Ω—è—Ç—å —Å–º—ã—Å–ª?
üß† –∑–∞–ø–æ–º–Ω–∏—Ç—å?
üëÄ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è?
‚≠ê –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å?"

[Inline –∫–Ω–æ–ø–∫–∏ - –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫]
```

**–î–∞–Ω–Ω—ã–µ:**
- `onboarding.current_step = "difficulty_type"`

**–®–∞–≥ 4: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª: "üîç –ø–æ–Ω—è—Ç—å —Å–º—ã—Å–ª"

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç:
- difficulty_type = "understanding_meaning"
- learning_profile.understanding_meaning += 1

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
"–•–æ—Ä–æ—à–æ. –ú—ã –Ω–∞—á–Ω—ë–º –∏–º–µ–Ω–Ω–æ —Å —ç—Ç–æ–≥–æ.
–ê –ø–æ—Ç–æ–º —Ä–∞–∑–±–µ—Ä—ë–º, —á—Ç–æ —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å, –∫–æ–≥–¥–∞ —É—á—ë–±–∞ –Ω–µ –∏–¥—ë—Ç.
–í–µ–¥—å –ü–æ–Ω–∏–º–∞–ª–∏—è ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–∞–Ω–∞ –∑–Ω–∞–Ω–∏–π,
—ç—Ç–æ —Å—Ç—Ä–∞–Ω–∞ —á—É–≤—Å—Ç–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç, —á—Ç–æ–±—ã –∏—Ö –ø–æ–Ω—è–ª–∏."

[–ü–∞—É–∑–∞ 1.5 —Å–µ–∫]

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ 2:
"–£—á—ë–±–∞ ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ –º–æ–∑–≥, –Ω–æ –∏ –ø—Ä–æ —á—É–≤—Å—Ç–≤–∞.
–ò–Ω–æ–≥–¥–∞ —Ç—Ä—É–¥–Ω–æ –Ω–µ –ø–æ—Ç–æ–º—É, —á—Ç–æ —Å–ª–æ–∂–Ω–æ,
–∞ –ø–æ—Ç–æ–º—É —á—Ç–æ –≥—Ä—É—Å—Ç–Ω–æ, —Å—Ç—Ä–∞—à–Ω–æ –∏–ª–∏ –æ–¥–∏–Ω–æ–∫–æ.

–ö–∞–∫ —Ç—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—à—å, –∫–æ–≥–¥–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è?"

[Inline –∫–Ω–æ–ø–∫–∏ - —Å–µ—Ç–∫–∞ 3x2]
üî• –ó–ª—é—Å—å       üíß –ì—Ä—É—â—É       üå´ –°—Ç—ã–¥–Ω–æ
üå™ –ë–æ—é—Å—å       ü™® –ù–∏—á–µ–≥–æ
```

**–î–∞–Ω–Ω—ã–µ:**
- `onboarding.current_step = "emotion_bridge"`

**–®–∞–≥ 5: –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª: "üå´ –°—Ç—ã–¥–Ω–æ"

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç:
- emotional_profile.primary_emotion = "shame"

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É (–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞):
"–°—Ç—ã–¥–Ω–æ ‚Äî –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –±—ã—Ç—å –ª—É—á—à–µ.
–Ø –ø–æ–º–æ–≥—É –±–µ–∑ —Å—Ç—ã–¥–∞.

–ó–Ω–∞–µ—à—å, –≤ –ü–æ–Ω–∏–º–∞–ª–∏–∏ –µ—Å—Ç—å –º–µ—Å—Ç–æ, –≥–¥–µ –∏—Å—á–µ–∑–∞—é—Ç –æ—Ü–µ–Ω–∫–∏.
–ù–∞–∑—ã–≤–∞–µ—Ç—Å—è –ì–æ—Ä–∞ –ü—É—Å—Ç–æ—Ç—ã.
–¢–∞–º –Ω–µ –≤–∞–∂–Ω–æ, –ø—è—Ç—å –∏–ª–∏ –¥–≤–∞. –í–∞–∂–Ω–æ —Ç–æ–ª—å–∫–æ —á—Ç–æ –¢–´ —Ö–æ—á–µ—à—å –ø–æ–Ω—è—Ç—å."

[–ü–∞—É–∑–∞ 1 —Å–µ–∫]

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
"–•–æ—á–µ—à—å —Ç—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è? –ò–ª–∏ —Å–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏—à—å –≤—Å—é –∫–∞—Ä—Ç—É?"

[Inline –∫–Ω–æ–ø–∫–∏]
üåÑ –ü–æ–π–¥—ë–º –≤ –ì–æ—Ä—É –ü—É—Å—Ç–æ—Ç—ã
üó∫Ô∏è –ü–æ–∫–∞–∂–∏ –∫–∞—Ä—Ç—É –ü–æ–Ω–∏–º–∞–ª–∏–∏
```

**–î–∞–Ω–Ω—ã–µ:**
- `onboarding.current_step = "location_choice"`
- –ë–æ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –ª–æ–∫–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ emotion + difficulty_type
  - shame + understanding_meaning ‚Üí Mountain of Emptiness

**–®–∞–≥ 6: –ü–æ–∫–∞–∑ –∫–∞—Ä—Ç—ã (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–ª "–ü–æ–∫–∞–∂–∏ –∫–∞—Ä—Ç—É")**
```
–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞—Ä—Ç—É:
"üó∫Ô∏è –ö–∞—Ä—Ç–∞ –ü–æ–Ω–∏–º–∞–ª–∏–∏

–í –ü–æ–Ω–∏–º–∞–ª–∏–∏ –∂–∏–≤—É—Ç —Ä–∞–∑–Ω—ã–µ –∑–µ–º–ª–∏ ‚Äî
–∫–∞–∂–¥–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —á–∞—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è.

üåÜ –ë–∞—à–Ω—è –ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏—è
‚îî‚îÄ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å–ª–æ–∂–Ω—ã–µ —Å–ª–æ–≤–∞ –≤ –ø–æ–Ω—è—Ç–Ω—ã–µ

üå≥ –î–æ–ª–∏–Ω–∞ –°–ª–æ–≤
‚îî‚îÄ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–ø–∞–≤—à–∏–µ —á—É–≤—Å—Ç–≤–∞

üåÑ –ì–æ—Ä–∞ –ü—É—Å—Ç–æ—Ç—ã ‚≠ê (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è —Ç–µ–±—è)
‚îî‚îÄ —É—á–∏—Ç –æ—Ç–ø—É—Å–∫–∞—Ç—å —è—Ä–ª—ã–∫–∏ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

üå≤ –õ–µ—Å –°–ø–æ–∫–æ–π—Å—Ç–≤–∏—è
‚îî‚îÄ –ø–æ–º–æ–≥–∞–µ—Ç —Ç–µ–ª—É –∏ –¥—ã—Ö–∞–Ω–∏—é

üß≠ –ì–æ—Ä–æ–¥ –†–∞–∑—É–º–∞
‚îî‚îÄ —É—á–∏—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ñ–∞–∫—Ç—ã –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å —Å–º—ã—Å–ª

–í—ã–±–µ—Ä–∏ —Ç–æ –º–µ—Å—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ –∑–æ–≤—ë—Ç —Ç–µ–±—è —Å–µ–≥–æ–¥–Ω—è."

[Inline –∫–Ω–æ–ø–∫–∏ - –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π]
```

**–®–∞–≥ 7: –ü–µ—Ä–≤—ã–π –º–∏–∫—Ä–æ–∫–≤–µ—Å—Ç**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª: "üåÑ –ì–æ—Ä–∞ –ü—É—Å—Ç–æ—Ç—ã"

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç:
- onboarding.first_location = "mountain_of_emptiness"
- current_location = "mountain_of_emptiness"

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç intro –ª–æ–∫–∞—Ü–∏–∏:
"üåÑ –ì–æ—Ä–∞ –ü—É—Å—Ç–æ—Ç—ã

–¢—ã –ø–æ–¥–Ω–∏–º–∞–µ—à—å—Å—è –ø–æ —Ç—Ä–æ–ø–µ, –∏ —á–µ–º –≤—ã—à–µ ‚Äî
—Ç–µ–º –ª–µ–≥—á–µ –¥—ã—à–∏—Ç—Å—è.
–ó–¥–µ—Å—å –Ω–µ—Ç —É—á–∏—Ç–µ–ª–µ–π, –Ω–µ—Ç –æ—Ü–µ–Ω–æ–∫.
–¢–æ–ª—å–∫–æ —Ç—ã –∏ —Ç–≤–æ–π –≤–æ–ø—Ä–æ—Å.

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ '–ø—è—Ç—ë—Ä–æ–∫' –∏ '–¥–≤–æ–µ–∫' –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.
–ß—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è?
–ß—Ç–æ —Ç—ã –°–ê–ú —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –≤ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ?"

[Text input field]
[Placeholder: "–ù–∞–ø—Ä–∏–º–µ—Ä: –ø–æ–Ω—è—Ç—å –¥—Ä–æ–±–∏, –Ω–∞—É—á–∏—Ç—å—Å—è —Ä–µ—à–∞—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è..."]
```

**–î–∞–Ω–Ω—ã–µ:**
- `onboarding.current_step = "first_quest"`
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–≤–µ—Å—Ç –∏–∑ `mountain_of_emptiness/quests/Q01_what_matters.yaml`

**–®–∞–≥ 8: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—Å–∞–ª: "–•–æ—á—É –ø–æ–Ω—è—Ç—å –¥—Ä–æ–±–∏"

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç:
- user_interests = ["–¥—Ä–æ–±–∏"]
- onboarding.user_goal = "–ø–æ–Ω—è—Ç—å –¥—Ä–æ–±–∏"

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
"–î—Ä–æ–±–∏! –û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä.
–ó–Ω–∞–µ—à—å, –¥—Ä–æ–±–∏ ‚Äî —ç—Ç–æ –∫–∞–∫ –∫—É—Å–æ—á–∫–∏ –ø–∏—Ä–æ–≥–∞.
–•–æ—á–µ—à—å, —è –ø–æ–∫–∞–∂—É –∫–≤–µ—Å—Ç '–î–µ–ª–∏ –∏ –ø–æ–Ω–∏–º–∞–π'?
–¢–∞–º –±—É–¥–µ—Ç –ø–∏—Ä–æ–≥, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–¥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ —á–∞—Å—Ç–∏."

[Inline –∫–Ω–æ–ø–∫–∏]
ü•ß –î–∞, –ø–æ–∫–∞–∂–∏ –∫–≤–µ—Å—Ç
üó∫Ô∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–∞—Ä—Ç–µ
```

**–®–∞–≥ 9: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞**
```
–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª "–î–∞, –ø–æ–∫–∞–∂–∏ –∫–≤–µ—Å—Ç":

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç:
- onboarding.completed = true
- onboarding.completed_at = timestamp

–ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–≤–µ—Å—Ç:
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è `mountain_of_emptiness/quests/Q02_fractions_pie.yaml`
- –ü–µ—Ä–µ—Ö–æ–¥ –≤ QuestEngine.start_quest()

[–û–Ω–±–æ—Ä–¥–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω, –¥–∞–ª—å—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç Quest Engine]
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—Ö–æ–¥ —á–µ—Ä–µ–∑ "–£—Å—Ç–∞–ª–æ—Å—Ç—å"

**–®–∞–≥ 1: –î–µ—Ç–µ–∫—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª: "üò¥ –£ –º–µ–Ω—è —É—Å—Ç–∞–ª–æ—Å—Ç—å"

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç:
- entry_button = "tired"
- emotional_profile.router_state = "tiredness"

EmotionalRouter –≤—ã–±–∏—Ä–∞–µ—Ç —Å—Ç–∏–ª—å:
- style = "short" (–∫–æ—Ä–æ—Ç–∫–∏–µ —Ñ—Ä–∞–∑—ã)
- pace_ms = 2000 (–º–µ–¥–ª–µ–Ω–Ω–æ)
- first_task = "draw_day_three_lines"
- mini_game = "catch_breath_dbt"
```

**–®–∞–≥ 2: –ú–∏–Ω–∏-–∏–≥—Ä–∞ –¥—ã—Ö–∞–Ω–∏—è**
```
–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
"–ü–æ–Ω–∏–º–∞—é. –ò–Ω–æ–≥–¥–∞ –º–æ–∑–≥ –ø—Ä–æ—Å–∏—Ç –ø–∞—É–∑—É.
–î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –æ–¥–Ω—É –º–∞–ª–µ–Ω—å–∫—É—é –∏–≥—Ä—É ‚Äî –æ–Ω–∞ –¥–ª–∏—Ç—Å—è 30 —Å–µ–∫—É–Ω–¥."

[Inline –∫–Ω–æ–ø–∫–∞]
ü´Å –ù–∞—á–∞—Ç—å –¥—ã—Ö–∞–Ω–∏–µ

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É.

–ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç MiniGame: catch_breath_dbt
- 3 —Ü–∏–∫–ª–∞ –≤–¥–æ—Ö-–≤—ã–¥–æ—Ö (4-6 —Ä–∏—Ç–º)
- –ê–Ω–∏–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:

–°–æ–æ–±—â–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É:
"üåü ... –≤–¥–æ—Ö ... 1"
"üåü ... –≤–¥–æ—Ö ... 2"
"üåü ... –≤–¥–æ—Ö ... 3"
"üåü ... –≤–¥–æ—Ö ... 4"
"üí® ... –≤—ã–¥–æ—Ö ... 1"
"üí® ... –≤—ã–¥–æ—Ö ... 2"
...
[–ü–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 3 —Ä–∞–∑–∞]

–§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
"‚ú® –ì–æ—Ç–æ–≤–æ! –ö–∞–∫ —Å–µ–π—á–∞—Å?"

[Inline –∫–Ω–æ–ø–∫–∏]
üòå –õ–µ–≥—á–µ
üò¥ –í—Å—ë –µ—â—ë —É—Å—Ç–∞–ª
üòä –•–æ—Ä–æ—à–æ
```

**–®–∞–≥ 3: –í–µ—Ç–≤–ª–µ–Ω–∏–µ**
```
–ï—Å–ª–∏ "üòå –õ–µ–≥—á–µ":
- –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –æ–ø—Ä–æ—Å—É (–®–∞–≥ 2 –°—Ü–µ–Ω–∞—Ä–∏—è 1)

–ï—Å–ª–∏ "üò¥ –í—Å—ë –µ—â—ë —É—Å—Ç–∞–ª":
- –ë–æ—Ç: "–ü–æ–Ω–∏–º–∞—é. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º —á—Ç–æ-—Ç–æ —Å–æ–≤—Å–µ–º –ø—Ä–æ—Å—Ç–æ–µ."
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∑–∞–¥–∞–Ω–∏–µ "–ù–∞—Ä–∏—Å—É–π –¥–µ–Ω—å —Ç—Ä–µ–º—è –ª–∏–Ω–∏—è–º–∏"
- –ü–æ—Å–ª–µ ‚Üí –æ–ø—Ä–æ—Å –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º —Å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏

–ï—Å–ª–∏ "üòä –•–æ—Ä–æ—à–æ":
- –ë–æ—Ç: "–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π –Ω–∞–π–¥—ë–º, –≥–¥–µ —É—á—ë–±–∞ –∑–∞–ø—É—Ç–∞–ª–∞—Å—å."
- –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø—Ä–æ—Å—É
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –í—Ö–æ–¥ —á–µ—Ä–µ–∑ "–ù–µ –∑–Ω–∞—é, –ø–æ–ª—É—á–∏—Ç—Å—è –ª–∏"

**–®–∞–≥ 1: –ü–æ–¥–¥–µ—Ä–∂–∫–∞**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª: "ü§î –ù–µ –∑–Ω–∞—é, –ø–æ–ª—É—á–∏—Ç—Å—è –ª–∏"

–ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç:
- entry_button = "not_sure"
- emotional_profile.router_state = "doubt"

EmotionalRouter –≤—ã–±–∏—Ä–∞–µ—Ç:
- style = "supportive"
- pace_ms = 1800 (gentle)

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
"–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –î–∞–≤–∞–π –ø–æ—Å–º–æ—Ç—Ä–∏–º, –≥–¥–µ –∏–º–µ–Ω–Ω–æ —Å—Ç–∞–ª–æ —Ç—Ä—É–¥–Ω–æ.

–ó–Ω–∞–µ—à—å, –≤ –ü–æ–Ω–∏–º–∞–ª–∏–∏ –Ω–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.
–ó–¥–µ—Å—å –≤–∞–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –¢–ï–ë–ï.

–ü–æ–ø—Ä–æ–±—É–µ–º –≤–º–µ—Å—Ç–µ?"

[Inline –∫–Ω–æ–ø–∫–∏]
‚ú® –ü–æ–ø—Ä–æ–±—É—é
üö™ –ü–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤
```

**–®–∞–≥ 2: –í–µ—Ç–≤–ª–µ–Ω–∏–µ**
```
–ï—Å–ª–∏ "‚ú® –ü–æ–ø—Ä–æ–±—É—é":
- –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø—Ä–æ—Å—É (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π flow)

–ï—Å–ª–∏ "üö™ –ü–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤":
- –ë–æ—Ç: "–ü–æ–Ω–∏–º–∞—é. –ö–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ /start.
        –ü–æ–Ω–∏–º–∞–ª–∏—è –Ω–∏–∫–æ–≥–æ –Ω–µ –¥–µ—Ä–∂–∏—Ç ‚ù§Ô∏è"
- onboarding.abandoned = true
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
```

---

## API –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### OnboardingManager

**`OnboardingManager.start(user_id, context)`**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: user_id, telegram context
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**`OnboardingManager.handle_button(user_id, button_id, context)`**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: user_id, button_id (–Ω–∞–ø—Ä. "yes_understand"), context
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∏
- –û–±–Ω–æ–≤–ª—è–µ—Ç onboarding.current_step

**`OnboardingManager.handle_text_input(user_id, text, context)`**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ (–¥–ª—è "–ß—Ç–æ —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å?")
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: user_id, text
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ user_interests
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –∫–≤–µ—Å—Ç–∞

**`OnboardingManager.is_completed(user_id)`**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: user_id
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: boolean

### EmotionalRouter

**`EmotionalRouter.detect_state(button_choice)`**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–µ
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: button_choice ("yes_understand" / "not_sure" / "tired")
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: router_state ("interest" / "doubt" / "tiredness")

**`EmotionalRouter.get_style_config(state)`**
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å—Ç–∏–ª—è –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: state
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: {style, pace_ms, first_task, mini_game}

**`EmotionalRouter.get_support_message(emotion)`**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–π —Ä–µ–ø–ª–∏–∫–∏ –¥–ª—è —ç–º–æ—Ü–∏–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: emotion ("anger" / "sadness" / "shame" / "fear" / "numbness")
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: —Ç–µ–∫—Å—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤

### LearningProfile

**`LearningProfile.update_from_survey(difficulty_type)`**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –æ–±—É—á–µ–Ω–∏—è –∏–∑ –æ–ø—Ä–æ—Å–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: difficulty_type ("understanding_meaning" / "memory" / "attention" / "motivation")
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç —Å—á–µ—Ç—á–∏–∫ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞

**`LearningProfile.recommend_location(emotion=None)`**
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ª–æ–∫–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ñ–∏–ª—è + —ç–º–æ—Ü–∏–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: emotion (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: location_id
- –õ–æ–≥–∏–∫–∞: combining difficulty_type + emotion ‚Üí location

**`LearningProfile.recommend_first_quest(location_id)`**
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∫–≤–µ—Å—Ç–∞ –≤ –ª–æ–∫–∞—Ü–∏–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: location_id
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: quest_id
- –í—ã–±–∏—Ä–∞–µ—Ç –∫–≤–µ—Å—Ç difficulty=easy –¥–ª—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞

### MiniGame

**`MiniGame.start(game_id, user_id, context)`**
- –ó–∞–ø—É—Å–∫ –º–∏–Ω–∏-–∏–≥—Ä—ã
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: game_id ("catch_breath_dbt"), user_id, context
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ó–∞–ø—É—Å–∫–∞–µ—Ç async loop –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏

**`MiniGame.animate_breathing(message_id, cycles=3)`**
- –ê–Ω–∏–º–∞—Ü–∏—è –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: message_id (–¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è), cycles
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –æ—Ü–µ–Ω–∫–∏

---

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### Flow: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥

```
User: /start
  ‚Üí Bot.handle_start()
  ‚Üí OnboardingManager.start(user_id)
  ‚Üí ScenarioEngine.load("onboarding/01_greeting.yaml")
  ‚Üí Bot sends greeting messages (3 messages with delays)
  ‚Üí Bot shows 3 buttons

User clicks: "üåü –î–∞, —Ö–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è"
  ‚Üí Bot.handle_callback_query()
  ‚Üí OnboardingManager.handle_button(user_id, "yes_understand")
  ‚Üí EmotionalRouter.detect_state("yes_understand") ‚Üí "interest"
  ‚Üí UserProfile.save({router_state: "interest"})
  ‚Üí ScenarioEngine.load("onboarding/02_subject_survey.yaml")
  ‚Üí Bot sends subject buttons

User clicks: "üî¢ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"
  ‚Üí OnboardingManager.handle_button(user_id, "mathematics")
  ‚Üí UserProfile.save({chosen_subject: "mathematics"})
  ‚Üí ScenarioEngine.load("onboarding/03_difficulty_type.yaml")
  ‚Üí Bot sends difficulty buttons

User clicks: "üîç –ø–æ–Ω—è—Ç—å —Å–º—ã—Å–ª"
  ‚Üí OnboardingManager.handle_button(user_id, "understanding_meaning")
  ‚Üí LearningProfile.update_from_survey("understanding_meaning")
  ‚Üí ScenarioEngine.load("onboarding/04_emotion_bridge.yaml")
  ‚Üí Bot sends emotion bridge message + emotion buttons

User clicks: "üå´ –°—Ç—ã–¥–Ω–æ"
  ‚Üí OnboardingManager.handle_button(user_id, "shame")
  ‚Üí EmotionalRouter.get_support_message("shame") ‚Üí –ø–æ–¥–¥–µ—Ä–∂–∫–∞
  ‚Üí LearningProfile.recommend_location(emotion="shame") ‚Üí "mountain_of_emptiness"
  ‚Üí Bot sends support + location recommendation

User clicks: "üåÑ –ü–æ–π–¥—ë–º –≤ –ì–æ—Ä—É"
  ‚Üí OnboardingManager.handle_button(user_id, "mountain_of_emptiness")
  ‚Üí LocationManager.enter_location("mountain_of_emptiness")
  ‚Üí ScenarioEngine.load("locations/mountain_of_emptiness/intro.yaml")
  ‚Üí Bot sends location intro + text input prompt

User types: "–•–æ—á—É –ø–æ–Ω—è—Ç—å –¥—Ä–æ–±–∏"
  ‚Üí OnboardingManager.handle_text_input(user_id, "–•–æ—á—É –ø–æ–Ω—è—Ç—å –¥—Ä–æ–±–∏")
  ‚Üí UserProfile.save({user_interests: ["–¥—Ä–æ–±–∏"]})
  ‚Üí LearningProfile.recommend_first_quest("mountain_of_emptiness") ‚Üí "Q02_fractions_pie"
  ‚Üí Bot sends quest recommendation

User clicks: "ü•ß –î–∞, –ø–æ–∫–∞–∂–∏ –∫–≤–µ—Å—Ç"
  ‚Üí OnboardingManager.complete()
  ‚Üí UserProfile.save({onboarding.completed: true})
  ‚Üí QuestEngine.start_quest("Q02_fractions_pie")
  ‚Üí [–ü–µ—Ä–µ—Ö–æ–¥ –≤ Quest flow]
```

### Flow: –í—Ö–æ–¥ —á–µ—Ä–µ–∑ —É—Å—Ç–∞–ª–æ—Å—Ç—å

```
User clicks: "üò¥ –£ –º–µ–Ω—è —É—Å—Ç–∞–ª–æ—Å—Ç—å"
  ‚Üí EmotionalRouter.detect_state("tired") ‚Üí "tiredness"
  ‚Üí EmotionalRouter.get_style_config("tiredness")
  ‚Üí MiniGame.start("catch_breath_dbt")
  ‚Üí MiniGame.animate_breathing(cycles=3)
  ‚Üí Bot shows feeling check buttons

User clicks: "üòå –õ–µ–≥—á–µ"
  ‚Üí OnboardingManager.handle_button("feeling_better")
  ‚Üí Continue to standard subject survey
```

---

## –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Week 1: Core Onboarding

**Day 1-2: Scenario Engine**
1. –°–æ–∑–¥–∞—Ç—å `ScenarioEngine` –∫–ª–∞—Å—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ YAML
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ YAML —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —à–∞–≥–æ–≤ (message, buttons, text_input)
4. –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –∑–∞–¥–µ—Ä–∂–µ–∫ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

**Day 3: Emotional Router**
1. –°–æ–∑–¥–∞—Ç—å `EmotionalRouter` –∫–ª–∞—Å—Å
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å 5 —Å–æ—Å—Ç–æ—è–Ω–∏–π (—Ç–∞–±–ª–∏—Ü–∞ –∏–∑ child start.md)
3. –î–æ–±–∞–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –∫–Ω–æ–ø–æ–∫ ‚Üí —Å–æ—Å—Ç–æ—è–Ω–∏—è
4. –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö —Ä–µ–ø–ª–∏–∫ –¥–ª—è —ç–º–æ—Ü–∏–π

**Day 4-5: Learning Profile**
1. –°–æ–∑–¥–∞—Ç—å `LearningProfile` –∫–ª–∞—Å—Å
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å 4 –∏–∑–º–µ—Ä–µ–Ω–∏—è (understanding/memory/attention/motivation)
3. –°–æ–∑–¥–∞—Ç—å –º–∞–ø–ø–∏–Ω–≥ difficulty_type ‚Üí –ª–æ–∫–∞—Ü–∏–∏
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –ª–æ–∫–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ñ–∏–ª—è + —ç–º–æ—Ü–∏–∏

**Day 6-7: OnboardingManager**
1. –°–æ–∑–¥–∞—Ç—å `OnboardingManager` –≥–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ handle –º–µ—Ç–æ–¥—ã (button, text_input)
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å ScenarioEngine, EmotionalRouter, LearningProfile
4. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ –≤ UserProfile

### Week 2: YAML Scenarios & Mini-Games

**Day 1-3: YAML —Ñ–∞–π–ª—ã**
1. –°–æ–∑–¥–∞—Ç—å –≤—Å–µ 7 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ (01-07)
2. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç—ã –∏–∑ child start.md
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –∏ –≤–µ—Ç–≤–ª–µ–Ω–∏—è
4. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é YAML —Å—Ö–µ–º—ã

**Day 4-5: Mini-Games**
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `MiniGame` –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
2. –°–æ–∑–¥–∞—Ç—å `catch_breath_dbt` (–∞–Ω–∏–º–∞—Ü–∏—è –¥—ã—Ö–∞–Ω–∏—è)
3. –°–æ–∑–¥–∞—Ç—å `catch_star_breathing` (–¥–ª—è —Ç—Ä–µ–≤–æ–≥–∏)
4. –°–æ–∑–¥–∞—Ç—å `virtual_burn` (–¥–ª—è –∑–ª–æ—Å—Ç–∏)
5. –°–æ–∑–¥–∞—Ç—å `draw_three_lines` (–¥–ª—è —É—Å—Ç–∞–ª–æ—Å—Ç–∏)

**Day 6-7: Location Metadata**
1. –°–æ–∑–¥–∞—Ç—å `locations_metadata.json` —Å 7 –ª–æ–∫–∞—Ü–∏—è–º–∏
2. –î–æ–±–∞–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –ª–æ–∫–∞—Ü–∏—è ‚Üí –º–æ–¥—É–ª–∏
3. –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è –∏ —ç–º–æ–¥–∑–∏
4. –°–æ–∑–¥–∞—Ç—å intro YAML –¥–ª—è –∫–∞–∂–¥–æ–π –ª–æ–∫–∞—Ü–∏–∏

---

## –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### 1. –†–µ–±–µ–Ω–æ–∫ –ø–æ–∫–∏–Ω—É–ª –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –Ω–∞ —Å–µ—Ä–µ–¥–∏–Ω–µ

**–°–∏—Ç—É–∞—Ü–∏—è:** –ù–∞—á–∞–ª –æ–Ω–±–æ—Ä–¥–∏–Ω–≥, –Ω–æ –∑–∞–∫—Ä—ã–ª –±–æ—Ç–∞ –Ω–∞ —à–∞–≥–µ "–í—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞"

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å `onboarding.current_step` –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º `/start` –ø—Ä–æ–≤–µ—Ä—è—Ç—å `onboarding.completed`
- –ï—Å–ª–∏ `completed = false`, –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å:
  - "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å —Ç–æ–≥–æ –º–µ—Å—Ç–∞" (–ø–æ–∫–∞–∑–∞—Ç—å current_step)
  - "–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ"
- –ù–ï –∑–∞—Å—Ç–∞–≤–ª—è—Ç—å –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –∑–∞–Ω–æ–≤–æ

**–ö–æ–¥:**
```python
if not profile.onboarding.completed:
    if profile.onboarding.current_step != "greeting":
        # –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±–æ—Ä
        return resume_or_restart_message()
```

### 2. –†–µ–±–µ–Ω–æ–∫ –≤—ã–±—Ä–∞–ª "–ù–µ –≥–æ—Ç–æ–≤" –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å–æ–º–Ω–µ–Ω–∏—è

**–°–∏—Ç—É–∞—Ü–∏—è:** –ù–∞–∂–∞–ª "üö™ –ü–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤" –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å `onboarding.abandoned = true`
- –ù–ï —Å–ø–∞–º–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º `/start`:
  - "–ü—Ä–∏–≤–µ—Ç —Å–Ω–æ–≤–∞! –ì–æ—Ç–æ–≤ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å?"
  - –î–∞—Ç—å —Ç–æ—Ç –∂–µ –≤—ã–±–æ—Ä (–î–∞ / –ü–æ–∫–∞ –Ω–µ—Ç)
- –ï—Å–ª–∏ "–ü–æ–∫–∞ –Ω–µ—Ç" 3 —Ä–∞–∑–∞ –ø–æ–¥—Ä—è–¥:
  - –ë–æ—Ç: "–•–æ—Ä–æ—à–æ, —è –±—É–¥—É –∂–¥–∞—Ç—å. –ù–∞–ø–∏—à–∏ –º–Ω–µ, –∫–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å."
  - `onboarding.attempts = 3` ‚Üí –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ

### 3. –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ —É–ª—É—á—à–∏–ª–æ—Å—å –ø–æ—Å–ª–µ –º–∏–Ω–∏-–∏–≥—Ä—ã

**–°–∏—Ç—É–∞—Ü–∏—è:** –í—ã–±—Ä–∞–ª "üò¥ –£—Å—Ç–∞–ª–æ—Å—Ç—å", –ø—Ä–æ—à–µ–ª –¥—ã—Ö–∞–Ω–∏–µ, –Ω–æ –Ω–∞–∂–∞–ª "üò¥ –í—Å—ë –µ—â—ë —É—Å—Ç–∞–ª"

**–†–µ—à–µ–Ω–∏–µ:**
- –ù–ï –ø–æ–≤—Ç–æ—Ä—è—Ç—å —Ç—É –∂–µ –º–∏–Ω–∏-–∏–≥—Ä—É
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É:
  - "–ü–æ–Ω–∏–º–∞—é. –î–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ."
  - –ó–∞–ø—É—Å—Ç–∏—Ç—å "draw_three_lines" (–±–æ–ª–µ–µ –ø–∞—Å—Å–∏–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ)
- –ï—Å–ª–∏ –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ "—É—Å—Ç–∞–ª":
  - "–ú–æ–∂–µ—Ç –±—ã—Ç—å, —Ç–µ–±–µ –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–µ–Ω –æ—Ç–¥—ã—Ö?
     –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è, –∫–æ–≥–¥–∞ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤ ‚ù§Ô∏è"
  - –†–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø–æ–∑–∂–µ

### 4. –¢–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥ –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π

**–°–∏—Ç—É–∞—Ü–∏—è:** –ù–∞ –≤–æ–ø—Ä–æ—Å "–ß—Ç–æ —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –≤ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ?" –Ω–∞–ø–∏—Å–∞–ª "asdfgh" –∏–ª–∏ –ø—É—Å—Ç–æ–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è: min_length = 3, max_length = 100
- –ï—Å–ª–∏ < 3 —Å–∏–º–≤–æ–ª–æ–≤:
  - "–ù–∞–ø–∏—à–∏ —Ö–æ—Ç—è –±—ã –ø–∞—Ä—É —Å–ª–æ–≤, —á—Ç–æ–±—ã —è –ø–æ–Ω—è–ª üôÇ"
- –ï—Å–ª–∏ —è–≤–Ω–∞—è –±–µ—Å—Å–º—ã—Å–ª–∏—Ü–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ª–æ–≤–∞—Ä—å):
  - "–ö–∞–∂–µ—Ç—Å—è, —Ç—ã —Ç–æ—Ä–æ–ø–∏—à—å—Å—è. –ü–æ–ø—Ä–æ–±—É–π –Ω–∞–ø–∏—Å–∞—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ?"
- –ü–æ—Å–ª–µ 2 –ø–æ–ø—ã—Ç–æ–∫:
  - –î–∞—Ç—å –∫–Ω–æ–ø–∫–∏ —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏:
    - [–î—Ä–æ–±–∏] [–£—Ä–∞–≤–Ω–µ–Ω–∏—è] [–ì–µ–æ–º–µ—Ç—Ä–∏—è] [–î—Ä—É–≥–æ–µ]

### 5. –í—ã–±—Ä–∞–ª —ç–º–æ—Ü–∏—é, –Ω–æ –Ω–µ —Ö–æ—á–µ—Ç –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—É—é –ª–æ–∫–∞—Ü–∏—é

**–°–∏—Ç—É–∞—Ü–∏—è:** –≠–º–æ—Ü–∏—è "—Å—Ç—ã–¥–Ω–æ" ‚Üí —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –ì–æ—Ä—É –ü—É—Å—Ç–æ—Ç—ã, –Ω–æ —Ä–µ–±–µ–Ω–æ–∫ —Ö–æ—á–µ—Ç –≤ –ë–∞—à–Ω—é

**–†–µ—à–µ–Ω–∏–µ:**
- –í–°–ï–ì–î–ê –¥–∞–≤–∞—Ç—å –≤—ã–±–æ—Ä:
  - "üåÑ –ü–æ–π–¥—ë–º –≤ –ì–æ—Ä—É –ü—É—Å—Ç–æ—Ç—ã" (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
  - "üó∫Ô∏è –ü–æ–∫–∞–∂–∏ –≤—Å—é –∫–∞—Ä—Ç—É"
- –ï—Å–ª–∏ –≤—ã–±—Ä–∞–ª "–ü–æ–∫–∞–∂–∏ –∫–∞—Ä—Ç—É":
  - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ 5 –ª–æ–∫–∞—Ü–∏–π –ë–ï–ó –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
  - –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—ã–±—Ä–∞—Ç—å –ª—é–±—É—é
  - –ù–ï –Ω–∞–≤—è–∑—ã–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä: `onboarding.ignored_recommendation = true`

---

## –û–±—ä–µ–º —Ä–∞–±–æ—Ç

### –ß—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ —ç—Ç–æ—Ç IP:

‚úÖ **–ü–æ–ª–Ω—ã–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ (7 —à–∞–≥–æ–≤)**
‚úÖ **3 —Å—Ü–µ–Ω–∞—Ä–∏—è –≤—Ö–æ–¥–∞** (—Å—Ç–∞–Ω–¥–∞—Ä—Ç / —É—Å—Ç–∞–ª–æ—Å—Ç—å / —Å–æ–º–Ω–µ–Ω–∏–µ)
‚úÖ **EmotionalRouter —Å 5 —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏**
‚úÖ **LearningProfile —Å 4 –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏**
‚úÖ **4 –º–∏–Ω–∏-–∏–≥—Ä—ã** (–¥—ã—Ö–∞–Ω–∏–µ, –∑–≤–µ–∑–¥–æ—á–∫–∞, —Å–∂–∏–≥–∞–Ω–∏–µ, —Ç—Ä–∏ –ª–∏–Ω–∏–∏)
‚úÖ **7 YAML —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤** –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
‚úÖ **7 –ª–æ–∫–∞—Ü–∏–π metadata** (–Ω–∞–∑–≤–∞–Ω–∏—è, —ç–º–æ–¥–∑–∏, –º–∞–ø–ø–∏–Ω–≥ –º–æ–¥—É–ª–µ–π)
‚úÖ **–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö —Ä–µ–ø–ª–∏–∫** –¥–ª—è 5 —ç–º–æ—Ü–∏–π
‚úÖ **Resume –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞** –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞
‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è** –æ–±—É—á–µ–Ω–∏—è –∏ —ç–º–æ—Ü–∏–π

### –ß—Ç–æ –ù–ï –≤—Ö–æ–¥–∏—Ç (–±—É–¥–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–∏—Ö IP):

‚ùå –ö–≤–µ—Å—Ç—ã –≤–Ω—É—Ç—Ä–∏ –ª–æ–∫–∞—Ü–∏–π (IP-04)
‚ùå Quest Engine (IP-04)
‚ùå NPC —Å–∏—Å—Ç–µ–º–∞ (IP-04)
‚ùå –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∞ –º–∏—Ä–∞ —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π (IP-03)
‚ùå Reality Bridge –º–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏—è (IP-05)
‚ùå –ü—Ä–æ–≥—Ä–µ—Å—Å –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (IP-05)

---

## –î–æ–ø—É—â–µ–Ω–∏—è

1. **–†–µ–±–µ–Ω–æ–∫ –ø–∏—à–µ—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ** - –Ω–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤
2. **–û–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø—Ä–æ—Ö–æ–¥–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑** - –Ω–µ–ª—å–∑—è —Å–±—Ä–æ—Å–∏—Ç—å –∏ –ø—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ (–∫—Ä–æ–º–µ —Å–ª—É—á–∞—è abandon)
3. **–ú–∏–Ω–∏-–∏–≥—Ä—ã —Ç–µ–∫—Å—Ç–æ–≤—ã–µ** - –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏, —Ç–æ–ª—å–∫–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
4. **–ù–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞** - —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –∏ –∫–Ω–æ–ø–∫–∏
5. **–í—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç MVP** - –≤—Å–µ 6 –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤–µ–¥—É—Ç –∫ –æ–¥–Ω–∏–º –ª–æ–∫–∞—Ü–∏—è–º
6. **Emotional router –ø—Ä–æ—Å—Ç–æ–π** - keyword matching, –Ω–µ NLP
7. **–ü–µ—Ä–≤—ã–π –∫–≤–µ—Å—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π** - –Ω–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–≤–µ—Å—Ç, –∞ –¥–µ–º–æ
8. **–õ–æ–∫–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Å—Ä–∞–∑—É –≤—Å–µ** - –Ω–µ—Ç —Å–∏—Å—Ç–µ–º—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ

---

## –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

1. **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–∏–Ω–∏-–∏–≥—Ä:** 30 —Å–µ–∫—É–Ω–¥ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –¥—ã—Ö–∞–Ω–∏—è –∏–ª–∏ –Ω—É–∂–Ω–æ 60?
2. **–ü–æ–≤—Ç–æ—Ä –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞:** –†–∞–∑—Ä–µ—à–∞—Ç—å –ª–∏ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `/reset`?
3. **–ü—Ä–æ–ø—É—Å–∫ —à–∞–≥–æ–≤:** –ú–æ–∂–Ω–æ –ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ —Å–æ–≤—Å–µ–º (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)?
4. **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞:** YAML —Ñ–∞–π–ª—ã –∏–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤?
5. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è:** –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ª–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∞—è –≤–µ—Ä—Å–∏—è –ø–æ–∑–∂–µ?
6. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—Ç—å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞?
7. **A/B —Ç–µ—Å—Ç—ã:** –ù—É–∂–Ω—ã –ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ç–µ–∫—Å—Ç–æ–≤ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è?

---

## Acceptance Criteria

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥

- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç `/start`
- [ ] –ü–æ–ª—É—á–∞–µ—Ç 3 —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
- [ ] –í–∏–¥–∏—Ç 3 –∫–Ω–æ–ø–∫–∏ (–î–∞ / –ù–µ –∑–Ω–∞—é / –£—Å—Ç–∞–ª–æ—Å—Ç—å)
- [ ] –ù–∞–∂–∏–º–∞–µ—Ç "–î–∞, —Ö–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è"
- [ ] –í–∏–¥–∏—Ç –æ–ø—Ä–æ—Å –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º (6 –∫–Ω–æ–ø–æ–∫)
- [ ] –í—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–µ–¥–º–µ—Ç (–ª—é–±–æ–π)
- [ ] –í–∏–¥–∏—Ç –æ–ø—Ä–æ—Å –ø–æ —Ç–∏–ø—É —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (4 –∫–Ω–æ–ø–∫–∏)
- [ ] –í—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- [ ] –í–∏–¥–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥ –∫ —ç–º–æ—Ü–∏—è–º + —Ç–µ–∫—Å—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- [ ] –í–∏–¥–∏—Ç –æ–ø—Ä–æ—Å –ø–æ —ç–º–æ—Ü–∏—è–º (5 –∫–Ω–æ–ø–æ–∫)
- [ ] –í—ã–±–∏—Ä–∞–µ—Ç —ç–º–æ—Ü–∏—é
- [ ] –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â—É—é —Ä–µ–ø–ª–∏–∫—É –¥–ª—è —ç—Ç–æ–π —ç–º–æ—Ü–∏–∏
- [ ] –í–∏–¥–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –ª–æ–∫–∞—Ü–∏–∏ + –∫–Ω–æ–ø–∫—É "–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É"
- [ ] –í—ã–±–∏—Ä–∞–µ—Ç –ª–æ–∫–∞—Ü–∏—é
- [ ] –í–∏–¥–∏—Ç intro –ª–æ–∫–∞—Ü–∏–∏
- [ ] –í–∏–¥–∏—Ç –∑–∞–ø—Ä–æ—Å —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ "–ß—Ç–æ —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å?"
- [ ] –ü–∏—à–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å (–º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞)
- [ ] –ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –∫–≤–µ—Å—Ç–∞
- [ ] –ù–∞–∂–∏–º–∞–µ—Ç "–î–∞, –ø–æ–∫–∞–∂–∏ –∫–≤–µ—Å—Ç"
- [ ] –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ completed
- [ ] –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Å chosen_subject, difficulty_type, emotional_state

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—Ö–æ–¥ —á–µ—Ä–µ–∑ —É—Å—Ç–∞–ª–æ—Å—Ç—å

- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "üò¥ –£ –º–µ–Ω—è —É—Å—Ç–∞–ª–æ—Å—Ç—å"
- [ ] –í–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "–ü–æ–Ω–∏–º–∞—é. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –∏–≥—Ä—É..."
- [ ] –í–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "ü´Å –ù–∞—á–∞—Ç—å –¥—ã—Ö–∞–Ω–∏–µ"
- [ ] –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É
- [ ] –í–∏–¥–∏—Ç –∞–Ω–∏–º–∞—Ü–∏—é –¥—ã—Ö–∞–Ω–∏—è (3 —Ü–∏–∫–ª–∞ –≤–¥–æ—Ö-–≤—ã–¥–æ—Ö)
- [ ] –ö–∞–∂–¥—ã–π —Ü–∏–∫–ª –∑–∞–Ω–∏–º–∞–µ—Ç ~10 —Å–µ–∫—É–Ω–¥
- [ ] –ü–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –≤–∏–¥–∏—Ç –≤–æ–ø—Ä–æ—Å "–ö–∞–∫ —Å–µ–π—á–∞—Å?"
- [ ] –í–∏–¥–∏—Ç 3 –∫–Ω–æ–ø–∫–∏ (–õ–µ–≥—á–µ / –í—Å—ë –µ—â—ë —É—Å—Ç–∞–ª / –•–æ—Ä–æ—à–æ)
- [ ] –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–õ–µ–≥—á–µ" ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø—Ä–æ—Å—É –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- [ ] –ü—Ä–∏ "–í—Å—ë –µ—â—ë —É—Å—Ç–∞–ª" ‚Üí –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
- [ ] –ü—Ä–∏ "–•–æ—Ä–æ—à–æ" ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø—Ä–æ—Å—É

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Resume –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞

- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∞–ª –æ–Ω–±–æ—Ä–¥–∏–Ω–≥, –¥–æ—à–µ–ª –¥–æ –≤—ã–±–æ—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–∞
- [ ] –ó–∞–∫—Ä—ã–ª –±–æ—Ç–∞ (–Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª –æ–Ω–±–æ—Ä–¥–∏–Ω–≥)
- [ ] –û—Ç–∫—Ä—ã–ª –±–æ—Ç–∞ —Å–Ω–æ–≤–∞, –Ω–∞–∂–∞–ª `/start`
- [ ] –í–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥?" —Å 2 –∫–Ω–æ–ø–∫–∞–º–∏
- [ ] –ù–∞–∂–∏–º–∞–µ—Ç "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
- [ ] –û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —à–∞–≥–µ –≤—ã–±–æ—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ (–≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è)
- [ ] –ó–∞–≤–µ—Ä—à–∞–µ—Ç –æ–Ω–±–æ—Ä–¥–∏–Ω–≥
- [ ] –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º `/start` –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: Abandon –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞

- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–ù–µ –∑–Ω–∞—é, –ø–æ–ª—É—á–∏—Ç—Å—è –ª–∏"
- [ ] –í–∏–¥–∏—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É + –∫–Ω–æ–ø–∫–∏ "–ü–æ–ø—Ä–æ–±—É—é / –ü–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤"
- [ ] –ù–∞–∂–∏–º–∞–µ—Ç "–ü–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤"
- [ ] –í–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "–ö–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—à—å ‚Äî –Ω–∞–ø–∏—à–∏ /start"
- [ ] –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ abandoned
- [ ] –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º `/start` –≤–∏–¥–∏—Ç "–ü—Ä–∏–≤–µ—Ç —Å–Ω–æ–≤–∞! –ì–æ—Ç–æ–≤ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å?"

### –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–ø–ª–∏–∫–∏

- [ ] –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "üî• –ó–ª—é—Å—å" ‚Üí —Ç–µ–∫—Å—Ç "–ó–ª–æ—Å—Ç—å ‚Äî –∑–Ω–∞—á–∏—Ç, —Ç–µ–±–µ –≤–∞–∂–Ω–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å..."
- [ ] –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "üíß –ì—Ä—É—â—É" ‚Üí —Ç–µ–∫—Å—Ç "–ì—Ä—É—Å—Ç—å ‚Äî —ç—Ç–æ –º–æ–∑–≥ —É—Å—Ç–∞–ª..."
- [ ] –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "üå´ –°—Ç—ã–¥–Ω–æ" ‚Üí —Ç–µ–∫—Å—Ç "–°—Ç—ã–¥–Ω–æ ‚Äî –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –±—ã—Ç—å –ª—É—á—à–µ..."
- [ ] –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "üå™ –ë–æ—é—Å—å" ‚Üí —Ç–µ–∫—Å—Ç "–°—Ç—Ä–∞—Ö ‚Äî —ç—Ç–æ —á–∞—Å—Ç—å –∑–∞–±–æ—Ç—ã –æ —Å–µ–±–µ..."
- [ ] –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "ü™® –ù–∏—á–µ–≥–æ" ‚Üí —Ç–µ–∫—Å—Ç "–ü—É—Å—Ç–æ—Ç–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–∞—É–∑–∞..."

---

## Definition of Done

- [ ] –ö–æ–¥ `OnboardingManager` –Ω–∞–ø–∏—Å–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] –ö–æ–¥ `EmotionalRouter` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å 5 —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
- [ ] –ö–æ–¥ `LearningProfile` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å 4 –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏
- [ ] –ö–æ–¥ `ScenarioEngine` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ —Ä–µ–Ω–¥–µ—Ä–∏—Ç YAML
- [ ] 4 –º–∏–Ω–∏-–∏–≥—Ä—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã (breathing, star, burn, lines)
- [ ] 7 YAML —Ñ–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω—ã –≤ `src/data/scenarios/onboarding/`
- [ ] `locations_metadata.json` —Å–æ–∑–¥–∞–Ω —Å 7 –ª–æ–∫–∞—Ü–∏—è–º–∏
- [ ] –®–∞–±–ª–æ–Ω—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö —Ä–µ–ø–ª–∏–∫ –¥–ª—è 5 —ç–º–æ—Ü–∏–π
- [ ] UserProfile —Å—Ö–µ–º–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∞ (onboarding, learning_profile, emotional_profile)
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö 4 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ acceptance criteria
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- [ ] –ú–µ—Ç—Ä–∏–∫–∏: onboarding_started, onboarding_completed, onboarding_abandoned

---

## –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ NFR –¥–ª—è MVP

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: < 500ms
- –ó–∞–≥—Ä—É–∑–∫–∞ YAML —Å—Ü–µ–Ω–∞—Ä–∏—è: < 100ms
- –ê–Ω–∏–º–∞—Ü–∏—è –¥—ã—Ö–∞–Ω–∏—è: —Ç–æ—á–Ω–æ—Å—Ç—å ¬±200ms –Ω–∞ —Ü–∏–∫–ª
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏: < 300ms

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞: –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ (–Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è)
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫—Ä–∞—à–∞: resume —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à–∞–≥–∞
- –¢–∞–π–º–∞—É—Ç—ã: –Ω–µ—Ç - —Ä–µ–±–µ–Ω–æ–∫ –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è —á–µ—Ä–µ–∑ –¥–µ–Ω—å

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- [ ] –ù–ï –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥ —Ä–µ–±–µ–Ω–∫–∞ (—Ç–æ–ª—å–∫–æ –¥–ª–∏–Ω—É)
- [ ] –ù–ï –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞: max 500 —Å–∏–º–≤–æ–ª–æ–≤ (–∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞)
- [ ] –•—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è: —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –Ω–µ –≤ Telegram cloud

---

## –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

### –õ–æ–≥–∏:
- `INFO`: onboarding_started, step_completed (step_id), onboarding_completed
- `WARNING`: invalid_text_input, step_abandoned
- `ERROR`: yaml_load_failed, profile_save_failed

### –ú–µ—Ç—Ä–∏–∫–∏:
- `onboarding_started_total` (counter)
- `onboarding_completed_total` (counter)
- `onboarding_abandoned_total` (counter)
- `onboarding_step_duration` (histogram by step_id)
- `entry_button_choice` (histogram: yes/no/tired)
- `subject_choice` (histogram: math/russian/history/etc)
- `difficulty_type` (histogram: understanding/memory/attention/motivation)
- `emotion_choice` (histogram: anger/sadness/shame/fear/numbness)
- `first_location` (histogram by location_id)

---

## –†–µ–ª–∏–∑

### Feature Flag:
- `ONBOARDING_ENABLED=true` –≤ `.env`
- –ü—Ä–∏ `false` - —Å—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥ –∫ –≥–ª–∞–≤–Ω–æ–º—É –º–µ–Ω—é (skip –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞)

### A/B —Ç–µ—Å—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- –í–∞—Ä–∏–∞–Ω—Ç A: —Ç–µ–∫—É—â–∏–µ —Ç–µ–∫—Å—Ç—ã
- –í–∞—Ä–∏–∞–Ω—Ç B: –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- –ú–µ—Ç—Ä–∏–∫–∞: completion_rate

---

## –û—Ç–∫–∞—Ç

### –£—Å–ª–æ–≤–∏—è:
- Completion rate < 30% (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ abandon)
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∞–≥–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ

### –î–µ–π—Å—Ç–≤–∏—è:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `ONBOARDING_ENABLED=false`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ø–∞–¥–∞—é—Ç —Å—Ä–∞–∑—É –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–π deploy —Å `ONBOARDING_ENABLED=true`

---

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

### –†–∏—Å–∫ 1: –¢–µ–∫—Å—Ç—ã —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ –¥–ª—è –¥–µ—Ç–µ–π 7-10 –ª–µ—Ç
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –≥—Ä—É–ø–ø
- A/B —Ç–µ—Å—Ç –∫–æ—Ä–æ—Ç–∫–∏—Ö vs –¥–ª–∏–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ–∫
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ—Ç alpha-—Ç–µ—Å—Ç–µ—Ä–æ–≤

### –†–∏—Å–∫ 2: –î–µ—Ç–∏ –ø–æ–∫–∏–¥–∞—é—Ç –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –Ω–∞ —Å–µ—Ä–µ–¥–∏–Ω–µ (–≤—ã—Å–æ–∫–∏–π abandon rate)
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- Resume —Ñ—É–Ω–∫—Ü–∏—è
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–æ—Ä–æ—Ç–∫–∏–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ (7 —à–∞–≥–æ–≤)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏

### –†–∏—Å–∫ 3: –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–ø–ª–∏–∫–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Ç–æ–Ω
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —Å –¥–µ—Ç—Å–∫–∏–º –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ —Ñ–æ–∫—É—Å-–≥—Ä—É–ø–ø–µ –¥–µ—Ç–µ–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –±–µ–∑ —Ä–µ–ª–∏–∑–∞ (YAML)

### –†–∏—Å–∫ 4: –ú–∏–Ω–∏-–∏–≥—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ–≤—ã—Ö
- –¢–∞–π–º–∞—É—Ç—ã –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –µ—Å–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∞)
- Fallback –Ω–∞ —Å—Ç–∞—Ç–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ edit failed

---

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–µ–∫–∞

- Python 3.11+
- python-telegram-bot 20.x
- PyYAML –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- asyncio –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
- JSON –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π (MVP)

---

## –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–Ω–∞

- [x] –ù–µ—Ç –∫–æ–¥–∞ - –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (—Ç–æ–ª—å–∫–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [x] –ó–∞–ø–æ–ª–Ω–µ–Ω—ã scope, acceptance, risks - –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- [x] –§–æ—Ä–º–∞—Ç IP-02 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–æ–≥–ª–∞—à–µ–Ω–∏—è–º - –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- [x] –ù–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤ - –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ–Ω—Ü–µ–ø—Ü–∏–µ–π child start.md - –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
