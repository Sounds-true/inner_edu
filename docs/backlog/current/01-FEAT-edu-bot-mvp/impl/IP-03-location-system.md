# IP-03: –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞—Ü–∏–π –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–∏—Ä—É –ü–æ–Ω–∏–º–∞–ª–∏–∏

## –°–º—ã—Å–ª –∏ —Ü–µ–ª—å –∑–∞–¥–∞—á–∏

–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä–æ–≤–æ–π –º–∏—Ä –ü–æ–Ω–∏–º–∞–ª–∏–∏ –∏–∑ 7 –ª–æ–∫–∞—Ü–∏–π, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∞—Å–ø–µ–∫—Ç—É –ø–æ–Ω–∏–º–∞–Ω–∏—è (–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–º—É –∏–ª–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É). –õ–æ–∫–∞—Ü–∏–∏ —Å–ª—É–∂–∞—Ç –º–µ—Ç–∞—Ñ–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º–∏, –≥–¥–µ —Ä–µ–±–µ–Ω–æ–∫ —á–µ—Ä–µ–∑ –∏–≥—Ä–æ–≤—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–≤–æ–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ —Å —É—á–µ–±–æ–π –∏ —ç–º–æ—Ü–∏—è–º–∏. –°–∏—Å—Ç–µ–º–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–π, –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞ –≤—ã–±–æ—Ä–æ–º –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –µ–≥–æ —Ç—É–¥–∞, –≥–¥–µ –æ–Ω –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
src/game/
‚îú‚îÄ‚îÄ location_manager.py         # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –ª–æ–∫–∞—Ü–∏–π
‚îú‚îÄ‚îÄ location.py                 # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å Location
‚îú‚îÄ‚îÄ locations/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ tower_confusion.py      # –ë–∞—à–Ω—è –ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ valley_words.py         # –î–æ–ª–∏–Ω–∞ –°–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ mountain_emptiness.py   # –ì–æ—Ä–∞ –ü—É—Å—Ç–æ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ forest_calm.py          # –õ–µ—Å –°–ø–æ–∫–æ–π—Å—Ç–≤–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ city_mind.py            # –ì–æ—Ä–æ–¥ –†–∞–∑—É–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ workshop_creator.py     # –ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è –¢–≤–æ—Ä—Ü–∞
‚îÇ   ‚îî‚îÄ‚îÄ bridge_actions.py       # –ú–æ—Å—Ç –î–µ–π—Å—Ç–≤–∏–π
‚îî‚îÄ‚îÄ navigation.py               # –õ–æ–≥–∏–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

src/data/locations/
‚îú‚îÄ‚îÄ tower_confusion.yaml        # –û–ø–∏—Å–∞–Ω–∏–µ, –∫–≤–µ—Å—Ç—ã, NPC
‚îú‚îÄ‚îÄ valley_words.yaml
‚îú‚îÄ‚îÄ mountain_emptiness.yaml
‚îú‚îÄ‚îÄ forest_calm.yaml
‚îú‚îÄ‚îÄ city_mind.yaml
‚îú‚îÄ‚îÄ workshop_creator.yaml
‚îî‚îÄ‚îÄ bridge_actions.yaml

src/data/maps/
‚îî‚îÄ‚îÄ ponimaliya_world.yaml       # –°–≤—è–∑–∏ –º–µ–∂–¥—É –ª–æ–∫–∞—Ü–∏—è–º–∏, —É—Å–ª–æ–≤–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Location

```yaml
id: tower_confusion
name: "–ë–∞—à–Ω—è –ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏—è"
symbol: "üåÜ"
unlock_condition: "onboarding_completed"
description_short: "–ú–µ—Å—Ç–æ, –≥–¥–µ —Å–ª–æ–∂–Ω—ã–µ —Å–ª–æ–≤–∞ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø–æ–Ω—è—Ç–Ω—ã–º–∏"
description_full: |
  –í—ã—Å–æ–∫–∞—è –±–∞—à–Ω—è –∏–∑ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–≥–æ —Å—Ç–µ–∫–ª–∞. –ß–µ–º –±–æ–ª—å—à–µ —Å–ª–æ–≤ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å,
  —Ç–µ–º –ø—Ä–æ–∑—Ä–∞—á–Ω–µ–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Å—Ç–µ–Ω—ã. –ó–¥–µ—Å—å –∂–∏–≤—É—Ç –•—Ä–∞–Ω–∏—Ç–µ–ª–∏ –¢–µ—Ä–º–∏–Ω–æ–≤.

emotional_themes:
  - "–Ω–µ –ø–æ–Ω–∏–º–∞—é"
  - "–≤—Å—ë —Å–ª–æ–∂–Ω–æ"
  - "—Å–ª–æ–≤–∞ –ø—É—Ç–∞—é—Ç—Å—è"

learning_profile_match:
  understanding_meaning: high    # –≠—Ç–∞ –ª–æ–∫–∞—Ü–∏—è –¥–ª—è —Ç–µ—Ö, —É –∫–æ–≥–æ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–º—ã—Å–ª–∞–º–∏
  memory: medium
  attention: medium
  motivation: low

available_npcs:
  - keeper_of_terms              # NPC, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç —Ç–µ—Ä–º–∏–Ω—ã
  - glass_guardian               # –ü–µ—Ä—Å–æ–Ω–∞–∂, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–µ–¥–∏—Ç –∑–∞ "–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é" –±–∞—à–Ω–∏

available_quests:
  - quest_id: explain_simple_words
    title: "–¢—Ä–∏ –ø—Ä–æ—Å—Ç—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏—è"
    description: "–í—ã–±–µ—Ä–∏ —Å–ª–æ–∂–Ω–æ–µ —Å–ª–æ–≤–æ –∏ –Ω–∞–π–¥–∏ –¥–ª—è –Ω–µ–≥–æ —Ç—Ä–∏ –ø—Ä–æ—Å—Ç—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏—è"

  - quest_id: term_hunt
    title: "–û—Ö–æ—Ç–∞ –∑–∞ —Ç–µ—Ä–º–∏–Ω–∞–º–∏"
    description: "–ù–∞–π–¥–∏ 5 —É—á–µ–±–Ω—ã—Ö —Å–ª–æ–≤ –∏ –æ–±—ä—è—Å–Ω–∏ –∏—Ö –º–ª–∞–¥—à–µ–º—É –¥—Ä—É–≥—É"

mini_games:
  - word_simplifier              # –ò–≥—Ä–∞ "—É–ø—Ä–æ—Å—Ç–∏ —Å–ª–æ–≤–æ"
  - term_matcher                 # –°–æ–ø–æ—Å—Ç–∞–≤—å —Ç–µ—Ä–º–∏–Ω –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ

psychological_modules:
  - 01_ifs_understanding         # –ß–∞—Å—Ç–∏ –ª–∏—á–Ω–æ—Å—Ç–∏ (–∫—Ä–∏—Ç–∏–∫ vs –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å)
  - 15_metacognition            # –ú–µ—Ç–∞–ø–æ–∑–Ω–∞–Ω–∏–µ: –∫–∞–∫ —è —É—á—É—Å—å

reality_bridge_examples:
  - "–ù–∞ —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–∫–µ –ø–æ–ø—Ä–æ—Å–∏ —É—á–∏—Ç–µ–ª—è –æ–±—ä—è—Å–Ω–∏—Ç—å –æ–¥–Ω–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–µ —Å–ª–æ–≤–æ"
  - "–ó–∞–ø–∏—à–∏ –≤ —Ç–µ—Ç—Ä–∞–¥—å —Ç—Ä–∏ —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ —Å–µ–≥–æ–¥–Ω—è —É–∑–Ω–∞–ª"

visual_elements:
  background_color: "#E8F4F8"   # –°–≤–µ—Ç–ª–æ-–≥–æ–ª—É–±–æ–π
  emoji_representation: "üåÜüîçüìñ"
  ascii_map: |
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë  –ë–ê–®–ù–Ø    ‚ïë
    ‚ïë           ‚ïë
    ‚ïë    üîç     ‚ïë
    ‚ïë           ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

### –°—Ö–µ–º–∞ –º–∏—Ä–∞ –ü–æ–Ω–∏–º–∞–ª–∏–∏

```
         [–ì–æ—Ä–∞ –ü—É—Å—Ç–æ—Ç—ã]
              ‚¨ÜÔ∏è
              ‚îÇ
    [–õ–µ—Å –°–ø–æ–∫–æ–π—Å—Ç–≤–∏—è] ‚Üê‚Üí [–ë–∞—à–Ω—è –ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏—è] ‚Üê‚Üí [–î–æ–ª–∏–Ω–∞ –°–ª–æ–≤]
              ‚îÇ                  ‚îÇ
              ‚¨áÔ∏è                  ‚¨áÔ∏è
        [–ì–æ—Ä–æ–¥ –†–∞–∑—É–º–∞]      [–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è –¢–≤–æ—Ä—Ü–∞]
              ‚îÇ                  ‚îÇ
              ‚îî‚îÄ‚îÄ‚Üí [–ú–æ—Å—Ç –î–µ–π—Å—Ç–≤–∏–π] ‚Üê‚îÄ‚îÄ‚îò
```

## –ü–æ–ª–Ω—ã–π flow —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∏—Ä–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ

1. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ (IP-02) LocationManager —á–∏—Ç–∞–µ—Ç ponimaliya_world.yaml
2. –°–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ –ª–æ–∫–∞—Ü–∏–π —Å —É—Å–ª–æ–≤–∏—è–º–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
3. –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–∞—è –ª–æ–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ:
   - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–±–µ–Ω–∫–∞ (–∏–∑ onboarding)
   - Learning profile (–∫–∞–∫–∞—è dimension —Å–∞–º–∞—è –Ω–∏–∑–∫–∞—è)
   - –í—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - –±–æ–ª—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å Tower)
4. User profile –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:
   ```json
   {
     "world": {
       "current_location": "tower_confusion",
       "unlocked_locations": ["tower_confusion"],
       "visited_locations": [],
       "location_progress": {
         "tower_confusion": {
           "first_visit": "2025-11-07T10:30:00Z",
           "visits_count": 1,
           "quests_completed": 0,
           "npcs_met": []
         }
       }
     }
   }
   ```

### 2. –í—Ö–æ–¥ –≤ –ª–æ–∫–∞—Ü–∏—é

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ª–æ–∫–∞—Ü–∏—é (–∫–Ω–æ–ø–∫–∞ –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞)
2. LocationManager.enter_location(location_id)
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:
   - –ï—Å–ª–∏ –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ - —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–∞–º–µ–∫–æ–º, –∫–∞–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
   - –ï—Å–ª–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–ø–∏—Å–∞–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
   - –ù–∞–∑–≤–∞–Ω–∏–µ –∏ —ç–º–æ–¥–∑–∏
   - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
   - –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π (–∫–≤–µ—Å—Ç—ã, NPC, –º–∏–Ω–∏-–∏–≥—Ä—ã)
   - –ü—Ä–æ–≥—Ä–µ—Å—Å –≤ —ç—Ç–æ–π –ª–æ–∫–∞—Ü–∏–∏ (—Å–∫–æ–ª—å–∫–æ –∫–≤–µ—Å—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
5. –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–æ–µ –ø–æ—Å–µ—â–µ–Ω–∏–µ - —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç—Å—è welcome-—Å—Ü–µ–Ω–∞—Ä–∏–π:
   ```yaml
   # tower_confusion.yaml
   first_visit_scenario:
     - text: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ë–∞—à–Ω—é –ù–µ–ø–æ–Ω–∏–º–∞–Ω–∏—è!"
     - text: "–ó–¥–µ—Å—å –∂–∏–≤—É—Ç —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–≤–æ–∏ –ø—Ä–æ—Å—Ç—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è."
     - text: "–ß–µ–º –±–æ–ª—å—à–µ —Ç—ã –∏—Ö –Ω–∞–π–¥—ë—à—å, —Ç–µ–º –ø—Ä–æ–∑—Ä–∞—á–Ω–µ–µ —Å—Ç–∞–Ω–µ—Ç –±–∞—à–Ω—è."
     - buttons:
       - "–í—Å—Ç—Ä–µ—Ç–∏—Ç—å –•—Ä–∞–Ω–∏—Ç–µ–ª—è –¢–µ—Ä–º–∏–Ω–æ–≤"
       - "–ù–∞—á–∞—Ç—å –∫–≤–µ—Å—Ç"
       - "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –∫–∞—Ä—Ç—É"
   ```

### 3. –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É –ª–æ–∫–∞—Ü–∏—è–º–∏

1. –ò–∑ –ª—é–±–æ–π –ª–æ–∫–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ "–ö–∞—Ä—Ç–∞ –ü–æ–Ω–∏–º–∞–ª–∏–∏" üó∫Ô∏è
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏:
   - ‚úÖ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –∏ –ø–æ—Å–µ—â–µ–Ω–∞
   - üîì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞, –Ω–æ –Ω–µ –ø–æ—Å–µ—â–µ–Ω–∞
   - üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (—Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π –∫–∞–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å)
   - ‚≠ê –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è)
3. NavigationEngine.recommend_location() –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç:
   - –¢–µ–∫—É—â–µ–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–µ—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ –∑–ª–æ–π ‚Üí City of Mind)
   - Learning profile (–≥–¥–µ –±–æ–ª—å—à–µ –ø—Ä–æ–±–µ–ª–æ–≤)
   - –ò—Å—Ç–æ—Ä–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–∫—É–¥–∞ –¥–∞–≤–Ω–æ –Ω–µ –∑–∞—Ö–æ–¥–∏–ª)
   - –í—Ä–µ–º—è —Å—É—Ç–æ–∫ (–≤–µ—á–µ—Ä–æ–º ‚Üí Forest of Calm –¥–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è)
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ª–æ–∫–∞—Ü–∏—é ‚Üí enter_location()

### 4. –£—Å–ª–æ–≤–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–æ–≤—ã—Ö –ª–æ–∫–∞—Ü–∏–π

–õ–æ–∫–∞—Ü–∏–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ:

- **Tower of Confusion**: –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- **Valley of Words**: —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ 1 –∫–≤–µ—Å—Ç–∞ –≤ –ª—é–±–æ–π –ª–æ–∫–∞—Ü–∏–∏
- **Forest of Calm**: –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—Ä–∞–∑—É (–¥–ª—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ä–µ–≥—É–ª—è—Ü–∏–∏)
- **Mountain of Emptiness**: –ø–æ—Å–ª–µ 3 –∫–≤–µ—Å—Ç–æ–≤ + –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ —Ä–µ–±–µ–Ω–æ–∫ –≤—ã—Ä–∞–∂–∞–µ—Ç —Å—Ç—ã–¥/—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
- **City of Mind**: –ø–æ—Å–ª–µ 5 –∫–≤–µ—Å—Ç–æ–≤
- **Workshop of Creator**: –ø–æ—Å–ª–µ 7 –∫–≤–µ—Å—Ç–æ–≤ + —Ö–æ—Ç—è –±—ã 1 Reality Bridge –≤—ã–ø–æ–ª–Ω–µ–Ω
- **Bridge of Actions**: –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–≥–¥–∞ (—ç—Ç–æ "–≤—ã—Ö–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å")

## API –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### LocationManager

**get_world_state(user_id: int) -> dict**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∏—Ä–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°–ø–∏—Å–æ–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π
- –¢–µ–∫—É—â–∞—è –ª–æ–∫–∞—Ü–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**enter_location(user_id: int, location_id: str) -> dict**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç—É–ø–∞
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ª–æ–∫–∞—Ü–∏–∏ –∏–∑ YAML
- –û–±–Ω–æ–≤–ª—è–µ—Ç user profile (—Ç–µ–∫—É—â–∞—è –ª–æ–∫–∞—Ü–∏—è, —Å—á–µ—Ç—á–∏–∫ –≤–∏–∑–∏—Ç–æ–≤)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–æ–ø–∏—Å–∞–Ω–∏–µ, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)

**exit_location(user_id: int) -> None**
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Ä–µ–º—è –≤—ã—Ö–æ–¥–∞
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∏–∑–∏—Ç–∞

**check_unlock_conditions(user_id: int) -> list**
- –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ª–æ–∫–∞—Ü–∏—è–º
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ - —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**get_location_progress(user_id: int, location_id: str) -> dict**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–∑–∏—Ç–æ–≤
- –ö–≤–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã / –¥–æ—Å—Ç—É–ø–Ω—ã
- NPC –≤—Å—Ç—Ä–µ—á–µ–Ω—ã
- –ü—Ä–æ—Ü–µ–Ω—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞—Ü–∏–∏

### Location (–±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å)

**load_from_yaml(yaml_path: str) -> Location**
- –ü–∞—Ä—Å–∏—Ç YAML —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ª–æ–∫–∞—Ü–∏–∏
- –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç Location —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏

**get_welcome_text(is_first_visit: bool) -> str**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- –†–∞–∑–Ω—ã–π –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤

**get_available_activities(user_id: int) -> list**
- –°–ø–∏—Å–æ–∫ –∫–≤–µ—Å—Ç–æ–≤ (–∞–∫—Ç–∏–≤–Ω—ã—Ö, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö)
- –°–ø–∏—Å–æ–∫ NPC
- –°–ø–∏—Å–æ–∫ –º–∏–Ω–∏-–∏–≥—Ä

**match_emotional_state(emotion: str) -> float**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç score –æ—Ç 0 –¥–æ 1, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ª–æ–∫–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ —ç–º–æ—Ü–∏—é
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

**match_learning_profile(profile: dict) -> float**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç score –æ—Ç 0 –¥–æ 1, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ª–æ–∫–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ learning profile
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

### NavigationEngine

**recommend_location(user_id: int) -> str**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç:
  - –ü–æ—Å–ª–µ–¥–Ω—é—é —ç–º–æ—Ü–∏—é (–∏–∑ emotional_router)
  - Learning profile
  - –ò—Å—Ç–æ—Ä–∏—é –ø–æ—Å–µ—â–µ–Ω–∏–π (–∫—É–¥–∞ –¥–∞–≤–Ω–æ –Ω–µ –∑–∞—Ö–æ–¥–∏–ª)
  - –í—Ä–µ–º—è —Å—É—Ç–æ–∫
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç location_id —Å –Ω–∞–∏–≤—ã—Å—à–∏–º score

**get_map_view(user_id: int) -> str**
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
- –° –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ —Å—Ç–∞—Ç—É—Å–∞ –ª–æ–∫–∞—Ü–∏–π (üîìüîí‚úÖ‚≠ê)

**calculate_location_score(user_id: int, location_id: str) -> float**
- –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –ª–æ–∫–∞—Ü–∏–∏
- –§–∞–∫—Ç–æ—Ä—ã:
  - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (40%)
  - Learning profile —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (30%)
  - –°–≤–µ–∂–µ—Å—Ç—å (–¥–∞–≤–Ω–æ –Ω–µ –±—ã–ª) (20%)
  - –í—Ä–µ–º—è —Å—É—Ç–æ–∫ (10%)

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
User Action (button/command)
         ‚Üì
    Bot Handler
         ‚Üì
  LocationManager
    ‚Üì          ‚Üì
Location    NavigationEngine
    ‚Üì          ‚Üì
 YAML    ‚Üí  Recommendation
    ‚Üì
QuestEngine / NPCSystem / MiniGameEngine
    ‚Üì
State Update ‚Üí JSON Storage
```

**–ü—Ä–∏–º–µ—Ä flow: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ª–æ–∫–∞—Ü–∏–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ**

1. User –∑–∞–≤–µ—Ä—à–∏–ª –∫–≤–µ—Å—Ç –≤ Tower of Confusion
2. Bot —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "–ö—É–¥–∞ –¥–∞–ª—å—à–µ? üó∫Ô∏è"
3. NavigationEngine.recommend_location(user_id) –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
4. Engine –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç:
   - –≠–º–æ—Ü–∏—è: "—Ä–∞–¥–æ—Å—Ç—å –æ—Ç —É—Å–ø–µ—Ö–∞" ‚Üí Valley of Words (–≤—ã—Ä–∞–∂–µ–Ω–∏–µ —á—É–≤—Å—Ç–≤)
   - Learning profile: motivation=2 (–Ω–∏–∑–∫–∞—è) ‚Üí Workshop of Creator (—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ)
   - History: –±—ã–ª 5 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥ –≤ Tower ‚Üí –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å
   - –í—Ä–µ–º—è: 15:00 (–¥–µ–Ω—å) ‚Üí –ª—é–±–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è –ª–æ–∫–∞—Ü–∏—è
5. Highest score: Workshop of Creator (0.85)
6. –ë–æ—Ç: "–°–º–æ—Ç—Ä—é, —É —Ç–µ–±—è —Ö–æ—Ä–æ—à–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å! üéâ –ü–æ–ø—Ä–æ–±—É–µ—à—å –ú–∞—Å—Ç–µ—Ä—Å–∫—É—é –¢–≤–æ—Ä—Ü–∞? –¢–∞–º –º–æ–∂–Ω–æ —á—Ç–æ-—Ç–æ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–∏–º–∏ —Ä—É–∫–∞–º–∏."
7. –ö–Ω–æ–ø–∫–∏: ["–î–∞, –∏–¥—ë–º! ‚≠ê", "–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É üó∫Ô∏è", "–û—Ç–¥–æ—Ö–Ω—É—Ç—å üåô"]

## –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (2-3 —á–∞—Å–∞)

1. –°–æ–∑–¥–∞—Ç—å Location –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
2. –°–æ–∑–¥–∞—Ç—å LocationManager —Å –º–µ—Ç–æ–¥–∞–º–∏ get_world_state, enter_location
3. –°–æ–∑–¥–∞—Ç—å YAML-—Ñ–∞–π–ª –¥–ª—è –æ–¥–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏ (Tower of Confusion)
4. –ù–∞–ø–∏—Å–∞—Ç—å –ø–∞—Ä—Å–µ—Ä YAML ‚Üí Location
5. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –∫–æ–º–∞–Ω–¥—É /map –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π

### –≠—Ç–∞–ø 2: –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (2-3 —á–∞—Å–∞)

1. –°–æ–∑–¥–∞—Ç—å NavigationEngine —Å –º–µ—Ç–æ–¥–æ–º recommend_location
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–∞ score –¥–ª—è –ª–æ–∫–∞—Ü–∏–π
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EmotionalRouter (–∏–∑ IP-02)
4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LearningProfile (–∏–∑ IP-02)
5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã

### –≠—Ç–∞–ø 3: –£—Å–ª–æ–≤–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (2 —á–∞—Å–∞)

1. –î–æ–±–∞–≤–∏—Ç—å unlock_condition –≤ YAML
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å check_unlock_conditions –≤ LocationManager
3. –õ–æ–≥–∏–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ —Å–æ–±—ã—Ç–∏—è—Ö (–∫–≤–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω, Reality Bridge –≤—ã–ø–æ–ª–Ω–µ–Ω)
4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–µ: "üéâ –û—Ç–∫—Ä—ã—Ç–∞ –Ω–æ–≤–∞—è –ª–æ–∫–∞—Ü–∏—è: –î–æ–ª–∏–Ω–∞ –°–ª–æ–≤!"

### –≠—Ç–∞–ø 4: –í—Å–µ 7 –ª–æ–∫–∞—Ü–∏–π (3-4 —á–∞—Å–∞)

1. –°–æ–∑–¥–∞—Ç—å YAML –¥–ª—è –≤—Å–µ—Ö 7 –ª–æ–∫–∞—Ü–∏–π
2. –ù–∞–ø–∏—Å–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è, —ç–º–æ–¥–∑–∏, —Ç–µ–º—ã
3. –°–≤—è–∑–∞—Ç—å —Å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –º–æ–¥—É–ª—è–º–∏
4. –î–æ–±–∞–≤–∏—Ç—å welcome-—Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤–∏–∑–∏—Ç–∞
5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ª–æ–∫–∞—Ü–∏—è–º–∏

### –≠—Ç–∞–ø 5: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ UX (2 —á–∞—Å–∞)

1. ASCII-–∞—Ä—Ç –∫–∞—Ä—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
2. –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π –ª–æ–∫–∞—Ü–∏–π
3. –≠–º–æ–¥–∑–∏-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤
4. –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (Inline keyboard Telegram)

## –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### 1. –õ–æ–∫–∞—Ü–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –≤–æ–π—Ç–∏ –≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–æ–∫–∞—Ü–∏—é
- –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "üîí –ú–æ—Å—Ç –î–µ–π—Å—Ç–≤–∏–π –ø–æ–∫–∞ –∑–∞–∫—Ä—ã—Ç. –ß—Ç–æ–±—ã –µ–≥–æ –æ—Ç–∫—Ä—ã—Ç—å, –≤—ã–ø–æ–ª–Ω–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∫–≤–µ—Å—Ç –∏ –ø–æ–ø—Ä–æ–±—É–π —Å–¥–µ–ª–∞—Ç—å Reality Bridge –∑–∞–¥–∞–Ω–∏–µ."
- –û–ø—Ü–∏—è: "–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É" –∏–ª–∏ "–í–µ—Ä–Ω—É—Ç—å—Å—è"

### 2. –ù–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (–≤—Å–µ –ª–æ–∫–∞—Ü–∏–∏ –ø–æ—Å–µ—â–µ–Ω—ã –Ω–µ–¥–∞–≤–Ω–æ)

- NavigationEngine –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç None
- –ë–æ—Ç: "–¢—ã —É–∂–µ –º–Ω–æ–≥–æ –≥–¥–µ –ø–æ–±—ã–≤–∞–ª —Å–µ–≥–æ–¥–Ω—è! üòä –ú–æ–∂–µ—Ç, –æ—Ç–¥–æ—Ö–Ω—ë–º? –ò–ª–∏ –≤—ã–±–µ—Ä–∏ —Å–∞–º –Ω–∞ –∫–∞—Ä—Ç–µ."
- –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É –±–µ–∑ —è–≤–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 3. –°–º–µ–Ω–∞ —ç–º–æ—Ü–∏–∏ –≤–æ –≤—Ä–µ–º—è –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è –≤ –ª–æ–∫–∞—Ü–∏–∏

- –†–µ–±–µ–Ω–æ–∫ –±—ã–ª –≤ Valley of Words (—Ä–∞–¥–æ—Å—Ç—å)
- –ù–∞—á–∞–ª –∫–≤–µ—Å—Ç, –Ω–æ –∑–∞—Å—Ç—Ä—è–ª ‚Üí —ç–º–æ—Ü–∏—è –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–∑–ª–æ—Å—Ç—å"
- EmotionalRouter –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –ë–æ—Ç –º—è–≥–∫–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç: "–ß—É–≤—Å—Ç–≤—É—é, —Å—Ç–∞–ª–æ —Ç—è–∂–µ–ª–æ–≤–∞—Ç–æ. –•–æ—á–µ—à—å –∑–∞–π—Ç–∏ –≤ –õ–µ—Å –°–ø–æ–∫–æ–π—Å—Ç–≤–∏—è, –ø–æ–¥—ã—à–∞—Ç—å?"
- –ù–æ –ù–ï –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ - —Ä–µ–±–µ–Ω–æ–∫ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å

### 4. –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É (–ø–æ—Å–ª–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞)

- –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è unlocked_locations –ø—É—Å—Ç–æ–π
- LocationManager –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –ª–æ–∫–∞—Ü–∏–∏:
  - Tower of Confusion (–≤—Å–µ–≥–¥–∞)
  - Forest of Calm (–≤—Å–µ–≥–¥–∞)
  - –û–¥–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞ –æ—Å–Ω–æ–≤–µ learning profile
- NavigationEngine —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –ø–µ—Ä–≤—É—é –ª–æ–∫–∞—Ü–∏—é

## –û–±—ä–µ–º —Ä–∞–±–æ—Ç

### –í—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

- –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å Location –∏ LocationManager
- NavigationEngine —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- 7 YAML-—Ñ–∞–π–ª–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ª–æ–∫–∞—Ü–∏–π
- 1 YAML-—Ñ–∞–π–ª —Å –∫–∞—Ä—Ç–æ–π –º–∏—Ä–∞ –∏ —Å–≤—è–∑—è–º–∏
- –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ª–æ–∫–∞—Ü–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EmotionalRouter –∏ LearningProfile
- –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±–æ—Ç–∞: /map, /location <id>, /where (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è)
- –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
- Welcome-—Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤–∏–∑–∏—Ç–∞ –≤ –∫–∞–∂–¥—É—é –ª–æ–∫–∞—Ü–∏—é

### –ù–µ –≤—Ö–æ–¥–∏—Ç –≤ MVP

- –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π)
- –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É –ª–æ–∫–∞—Ü–∏—è–º–∏
- –ì–æ–ª–æ—Å–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –ª–æ–∫–∞—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –°–∏—Å—Ç–µ–º–∞ "–ø–æ–≥–æ–¥—ã" –≤ –ª–æ–∫–∞—Ü–∏—è—Ö (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏ –º–µ–Ω—è–µ—Ç—Å—è)
- –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –ª–æ–∫–∞—Ü–∏–∏ –∏–ª–∏ "–ø–∞—Å—Ö–∞–ª–∫–∏"

## –î–æ–ø—É—â–µ–Ω–∏—è

- **–î–æ–ø—É—â–µ–Ω–∏–µ 1**: –†–µ–±–µ–Ω–æ–∫ 7-14 –ª–µ—Ç —Ö–æ—Ä–æ—à–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏—è—Ö –∏ —ç–º–æ–¥–∑–∏. –ï—Å–ª–∏ –Ω–µ—Ç - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤—ã–µ –ø–æ—è—Å–Ω–µ–Ω–∏—è –ø–æ–∑–∂–µ.
- **–î–æ–ø—É—â–µ–Ω–∏–µ 2**: Telegram Bot API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Inline Keyboard —Å —ç–º–æ–¥–∑–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.
- **–î–æ–ø—É—â–µ–Ω–∏–µ 3**: YAML –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π. –î–∏–Ω–∞–º–∏–∫–∞ (–∫–≤–µ—Å—Ç—ã, NPC) –±—É–¥–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª—è—Ö.
- **–î–æ–ø—É—â–µ–Ω–∏–µ 4**: JSON-—Ñ–∞–π–ª user profile –Ω–µ —Å—Ç–∞–Ω–µ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º location_progress. –ï—Å–ª–∏ —Å—Ç–∞–Ω–µ—Ç - –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ SQLite.
- **–î–æ–ø—É—â–µ–Ω–∏–µ 5**: 7 –ª–æ–∫–∞—Ü–∏–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è MVP. –ü–æ–∑–∂–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—É–±–ª–æ–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü–æ–¥–≤–∞–ª –ë–∞—à–Ω–∏", "–í–µ—Ä—à–∏–Ω–∞ –ì–æ—Ä—ã").

## –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

1. **–ù—É–∂–Ω–∞ –ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ª–æ–∫–∞—Ü–∏–π –≤–æ–æ–±—â–µ?** –ò–ª–∏ –ª—É—á—à–µ –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—å —Å—Ä–∞–∑—É, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –Ω—É–∂–Ω—ã–µ? (–†–∏—Å–∫: —Ä–µ–±–µ–Ω–æ–∫ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è)
2. **–°–∫–æ–ª—å–∫–æ –ª–æ–∫–∞—Ü–∏–π –º–æ–∂–Ω–æ –ø–æ—Å–µ—â–∞—Ç—å –∑–∞ –æ–¥–Ω—É —Å–µ—Å—Å–∏—é?** –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∏–ª–∏ –¥–∞—Ç—å —Å–≤–æ–±–æ–¥—É? (–î–ª—è MVP - —Å–≤–æ–±–æ–¥–∞)
3. **–î–æ–ª–∂–Ω–∞ –ª–∏ –∫–∞—Ä—Ç–∞ –±—ã—Ç—å –ª–∏–Ω–µ–π–Ω–æ–π –∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ–π?** –°–µ–π—á–∞—Å –∑–∞–¥—É–º–∞–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∞—è (–∑–≤–µ–∑–¥–∞), –Ω–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ª–∏–Ω–µ–π–Ω—ã–π –ø—É—Ç—å –¥–ª—è –Ω–∞—á–∞–ª–∞.
4. **–ù—É–∂–µ–Ω –ª–∏ "–¥–æ–º–∞—à–Ω–∏–π —Ö–∞–±" (—Å—Ç–∞—Ä—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞)?** –ò–ª–∏ —Å—Ä–∞–∑—É –≤ –ª–æ–∫–∞—Ü–∏–∏? (–î–ª—è MVP - —Å—Ä–∞–∑—É –≤ –ª–æ–∫–∞—Ü–∏–∏)

## Acceptance criteria

### –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- [ ] –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –º–∏—Ä–∞ –ü–æ–Ω–∏–º–∞–ª–∏–∏
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞—Ä—Ç–∞ —Å 2-3 —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ª–æ–∫–∞—Ü–∏—è–º–∏ (Tower, Forest, +1)
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –≤ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–æ–∫–∞—Ü–∏—é –∏ —É–≤–∏–¥–µ—Ç—å –µ—ë –æ–ø–∏—Å–∞–Ω–∏–µ
- [ ] –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ –ª–æ–∫–∞—Ü–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π (–∫–≤–µ—Å—Ç—ã, NPC, –∏–≥—Ä—ã)
- [ ] –ö–æ–º–∞–Ω–¥–∞ /map –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç—É —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ (üîìüîí‚úÖ‚≠ê)
- [ ] NavigationEngine —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –ª–æ–∫–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–æ—Ü–∏–∏ –∏ learning profile
- [ ] –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π –Ω–æ–≤–∞—è –ª–æ–∫–∞—Ü–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

- [ ] –ï—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ –≤—ã–±—Ä–∞–ª —ç–º–æ—Ü–∏—é "—É—Å—Ç–∞–ª–æ—Å—Ç—å" ‚Üí —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Forest of Calm
- [ ] –ï—Å–ª–∏ learning profile –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∏–∑–∫–æ–µ understanding_meaning ‚Üí —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Tower of Confusion
- [ ] –ï—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ –¥–∞–≤–Ω–æ –Ω–µ –±—ã–ª –≤ –ª–æ–∫–∞—Ü–∏–∏ (>3 –¥–Ω—è) ‚Üí –æ–Ω–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
- [ ] –í–µ—á–µ—Ä–æ–º (–ø–æ—Å–ª–µ 19:00) –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É Forest of Calm

### –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

- [ ] –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–æ–∫–∞—Ü–∏—é ‚Üí –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —É—Å–ª–æ–≤–∏–µ–º —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- [ ] –ï—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π ‚Üí –±–æ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ—Ç–¥–æ—Ö–Ω—É—Ç—å –∏–ª–∏ –≤—ã–±—Ä–∞—Ç—å —Å–∞–º–æ–º—É
- [ ] –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥ –ø–æ—Å–ª–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –ª–æ–∫–∞—Ü–∏–∏
- [ ] –°–º–µ–Ω–∞ —ç–º–æ—Ü–∏–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ ‚Üí –±–æ—Ç –º—è–≥–∫–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥—Ä—É–≥—É—é –ª–æ–∫–∞—Ü–∏—é, –Ω–æ –Ω–µ –ø—Ä–∏–Ω—É–∂–¥–∞–µ—Ç

### –†—É—á–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–æ–≤–µ—Ä–∫–∏

1. –ó–∞–≤–µ—Ä—à–∏—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏—Å—å Tower of Confusion –∏ Forest of Calm
3. –í–æ–π—Ç–∏ –≤ Tower of Confusion ‚Üí —É–≤–∏–¥–µ—Ç—å welcome-—Ç–µ–∫—Å—Ç
4. –í—ã–ø–æ–ª–Ω–∏—Ç—å 1 –∫–≤–µ—Å—Ç ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Valley of Words —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞—Å—å
5. –°–º–µ–Ω–∏—Ç—å —ç–º–æ—Ü–∏—é –Ω–∞ "–∑–ª–æ—Å—Ç—å" ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±–æ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç City of Mind
6. –ü–æ—Å–µ—Ç–∏—Ç—å 5 –ª–æ–∫–∞—Ü–∏–π ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ City of Mind —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª—Å—è
7. –ö–æ–º–∞–Ω–¥–∞ /map ‚Üí —É–≤–∏–¥–µ—Ç—å –∫–∞—Ä—Ç—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏

## Definition of Done

- [ ] –ö–æ–¥ LocationManager –∏ NavigationEngine –Ω–∞–ø–∏—Å–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í—Å–µ 7 YAML-—Ñ–∞–π–ª–æ–≤ –ª–æ–∫–∞—Ü–∏–π —Å–æ–∑–¥–∞–Ω—ã —Å –ø–æ–ª–Ω—ã–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
- [ ] YAML —Å –∫–∞—Ä—Ç–æ–π –º–∏—Ä–∞ –∏ —É—Å–ª–æ–≤–∏—è–º–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–æ–∑–¥–∞–Ω
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EmotionalRouter –∏ LearningProfile —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ª–æ–∫–∞—Ü–∏–π –ø–æ —É—Å–ª–æ–≤–∏—è–º —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ö–æ–º–∞–Ω–¥—ã /map, /location, /where –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±–æ—Ç–∞
- [ ] –õ–æ–≥–∏ –¥–ª—è –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π (–≤—Ö–æ–¥ –≤ –ª–æ–∫–∞—Ü–∏—é, —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è) –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] –ö—Ä–∞—Ç–∫–∏–π README –≤ docs/features/location_system.md —Å–æ–∑–¥–∞–Ω

## –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ NFR –¥–ª—è MVP

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–∏ –∏–∑ YAML: <50ms
- –†–∞—Å—á–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: <100ms
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç—ã: <50ms
- –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –¥–æ 100 –±–µ–∑ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- –ï—Å–ª–∏ YAML –ª–æ–∫–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí fallback –Ω–∞ generic –æ–ø–∏—Å–∞–Ω–∏–µ + –ª–æ–≥ –æ—à–∏–±–∫–∏
- –ï—Å–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–∞–¥–∞–µ—Ç ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É –±–µ–∑ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ï—Å–ª–∏ unlock_condition –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π ‚Üí –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å, –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å warning

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–µ—Å—É—Ä—Å–∞–º

- YAML —Ñ–∞–π–ª—ã: –¥–æ 10KB –∫–∞–∂–¥—ã–π
- User profile location_progress: –¥–æ 50KB –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í –ø–∞–º—è—Ç–∏: –∫—ç—à –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π (–¥–æ 7 –æ–±—ä–µ–∫—Ç–æ–≤, ~100KB)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- YAML —Ñ–∞–π–ª—ã –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ –∫–æ–¥–∞ (—Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ)
- User profile –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ LocationManager API
- –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ "–≤–∑–ª–æ–º–∞—Ç—å" —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ª–æ–∫–∞—Ü–∏–π —á–µ—Ä–µ–∑ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—é –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç PII (—Ç–æ–ª—å–∫–æ user_id)

## –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

### –õ–æ–≥–∏

- INFO: "User {user_id} entered location {location_id}"
- INFO: "User {user_id} unlocked location {location_id}"
- INFO: "Recommended location {location_id} for user {user_id} with score {score}"
- ERROR: "Failed to load location {location_id} from YAML: {error}"
- WARNING: "Invalid unlock_condition for {location_id}: {condition}"

### –ú–µ—Ç—Ä–∏–∫–∏

- –°—á–µ—Ç—á–∏–∫ –≤—Ö–æ–¥–æ–≤ –≤ –∫–∞–∂–¥—É—é –ª–æ–∫–∞—Ü–∏—é
- –°—á–µ—Ç—á–∏–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- –°—á–µ—Ç—á–∏–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (–ø—Ä–∏–Ω—è—Ç–æ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–æ)
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è –≤ –ª–æ–∫–∞—Ü–∏–∏
- –¢–æ–ø-3 —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ª–æ–∫–∞—Ü–∏–∏

### –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞

- Span: location_entry (–æ—Ç –∑–∞–ø—Ä–æ—Å–∞ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö)
- Span: recommendation_calculation (–æ—Ç –≤—ã–∑–æ–≤–∞ –¥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞)

## –†–µ–ª–∏–∑

- –í–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ feature flag: `features.location_system.enabled`
- –ï—Å–ª–∏ —Ñ–ª–∞–≥ –≤—ã–∫–ª—é—á–µ–Ω ‚Üí –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ "–æ–¥–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ª–æ–∫–∞—Ü–∏—è" (–≤—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ)
- –ü–ª–∞–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
  1. –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: –≤–∫–ª—é—á–∏—Ç—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö —é–∑–µ—Ä–æ–≤
  2. Staging: –≤–∫–ª—é—á–∏—Ç—å –¥–ª—è 20% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å 24 —á–∞—Å–∞
  3. Production: –≤–∫–ª—é—á–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö

## –û—Ç–∫–∞—Ç

### –£—Å–ª–æ–≤–∏—è –æ—Ç–∫–∞—Ç–∞

- –ü–∞–¥–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (error rate >10%)
- –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ YAML (>5% –∑–∞–ø—Ä–æ—Å–æ–≤)
- –ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—é (>10 –∑–∞ 1 —á–∞—Å)

### –®–∞–≥–∏ –æ—Ç–∫–∞—Ç–∞

1. –í—ã–∫–ª—é—á–∏—Ç—å feature flag: `features.location_system.enabled = false`
2. –ë–æ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫ —Ä–µ–∂–∏–º—É "–±–µ–∑ –ª–æ–∫–∞—Ü–∏–π" (IP-02 onboarding + –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –∫–≤–µ—Å—Ç–∞–º)
3. User profile –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–¥–∞–Ω–Ω—ã–µ –æ location_progress –ø—Ä–æ—Å—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)
4. –õ–æ–≥–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã
5. –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–ª–∏–∑ –ø–æ —Ç–æ–π –∂–µ —Å—Ö–µ–º–µ

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

### –†–∏—Å–∫ 1: –†–µ–±–µ–Ω–æ–∫ –∑–∞–±–ª—É–¥–∏—Ç—Å—è –≤ 7 –ª–æ–∫–∞—Ü–∏—è—Ö

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- –°–∏–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥)
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä 2-3 –ª–æ–∫–∞—Ü–∏—è–º–∏
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É /help_where "–Ø –Ω–µ –∑–Ω–∞—é, –∫—É–¥–∞ –∏–¥—Ç–∏"

### –†–∏—Å–∫ 2: YAML —Ñ–∞–π–ª—ã —Å—Ç–∞–Ω—É—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º–∏ –∏ —Å–ª–æ–∂–Ω—ã–º–∏

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- –î–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã–µ –≤ YAML (–æ–ø–∏—Å–∞–Ω–∏—è, —Å–≤—è–∑–∏)
- –ö–≤–µ—Å—Ç—ã, NPC, –∏–≥—Ä—ã - –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª—è—Ö
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π review —Ä–∞–∑–º–µ—Ä–∞ YAML

### –†–∏—Å–∫ 3: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±—É–¥—É—Ç –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º–∏

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤—ã–±–æ—Ä
- A/B —Ç–µ—Å—Ç –≤–µ—Å–æ–≤ –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ recommendation
- –§–∏–¥–±–µ–∫ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: "–ú–Ω–µ —ç—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç?" (–ª–∞–π–∫/–¥–∏–∑–ª–∞–π–∫)

### –†–∏—Å–∫ 4: –î–µ—Ç–∏ –±—É–¥—É—Ç –∑–∞—Å—Ç—Ä–µ–≤–∞—Ç—å –≤ –æ–¥–Ω–æ–π –ª—é–±–∏–º–æ–π –ª–æ–∫–∞—Ü–∏–∏

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- –ú—è–≥–∫–æ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –¥—Ä—É–≥–∏–µ –ª–æ–∫–∞—Ü–∏–∏ –ø–æ—Å–ª–µ 3+ –≤–∏–∑–∏—Ç–æ–≤ –ø–æ–¥—Ä—è–¥
- –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è: "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ—Ö –∑–µ–º–µ–ª—å" (–±–µ–π–¥–∂ –∑–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–æ–∫–∞—Ü–∏–π)
- –ö–≤–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –ø–æ—Å–µ—â–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–æ–∫–∞—Ü–∏–π

### –†–∏—Å–∫ 5: –£—Å–ª–æ–≤–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–µ

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- –î–ª—è MVP - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç—ã–µ —É—Å–ª–æ–≤–∏—è (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–≤–µ—Å—Ç–æ–≤)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: —Å–∫–æ–ª—å–∫–æ –¥–µ—Ç–µ–π –∑–∞—Å—Ç—Ä–µ–≤–∞—é—Ç –Ω–∞ –æ–¥–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–π —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–µ–∫–∞

- **–Ø–∑—ã–∫**: Python 3.11+
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: python-telegram-bot 20.x
- **–ü–∞—Ä—Å–∏–Ω–≥ YAML**: PyYAML 6.0+
- **–•—Ä–∞–Ω–∏–ª–∏—â–µ**: JSON-—Ñ–∞–π–ª—ã (–¥–ª—è MVP), –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è SQLite –¥–ª—è user profile
- **–î–µ–ø–ª–æ–π**: Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (Yandex Cloud / GCP)

## –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–Ω–∞ –ø–µ—Ä–µ–¥ –≤—ã–¥–∞—á–µ–π

- [x] –ù–µ—Ç –∫–æ–¥–∞ –∏ –ø—Å–µ–≤–¥–æ–∫–æ–¥–∞ (—Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ª–æ–≥–∏–∫–∞)
- [x] –ó–∞–ø–æ–ª–Ω–µ–Ω—ã scope, acceptance, risk, release
- [x] –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞: IP-03-location-system.md
- [x] –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö URL
- [x] –í—Å–µ –ø—É—Ç–∏ –≤ POSIX-—Ñ–æ—Ä–º–∞—Ç–µ

## –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ "–ª–æ–º–∫–æ–π" API

- [x] –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–Ω–µ—à–Ω–∏—Ö –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π API (MVP, –Ω–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤)
- [x] –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞—á –≤ —Ç–µ–∫—É—â–µ–º —Å–ø—Ä–∏–Ω—Ç–µ

## –ü—Ä–æ—Ñ–∏–ª—å —è–∑—ã–∫–∞

- primary_language: python
- stdlib_preferred: true
- external_libs: PyYAML (–¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –ª–æ–∫–∞—Ü–∏–π), python-telegram-bot (–¥–ª—è UI)
